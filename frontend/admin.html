<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚öîÔ∏è BRGY TAMAGO Command Center - Gaming Admin Dashboard</title>
    <link rel="icon" type="image/svg+xml" href="assets/images/favicon.svg">
    <link rel="alternate icon" href="assets/images/favicon.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.7.0/flowbite.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Brgy Tamago Official Brand Colors
                        'brand-gold': '#fdbd16',        // Primary Gold/Yellow
                        'brand-red': '#f22524',         // Primary Red
                        'brand-black': '#1f1f20',       // Dark Background
                        'brand-white': '#ffffff',       // White
                        'brand-beige': '#e3c293',       // Tan/Beige accent
                        'brand-orange': '#ef6d1f',      // Orange accent
                        'brand-gray': '#585858',        // Gray
                        
                        // Derived shades for UI
                        'brand-gold-light': '#ffd03a',  // Lighter gold
                        'brand-gold-dark': '#e5aa00',   // Darker gold
                        'brand-gray-light': '#6E6E6E',  // Lighter gray
                        'brand-gray-dark': '#3A3A3A',   // Darker gray
                        'brand-red-light': '#ff4447',   // Lighter red
                        'brand-red-dark': '#d01619',    // Darker red
                        
                        // Legacy gaming colors (mapped to new colors)
                        'gaming-dark': '#1f1f20',       // Now uses brand-black
                        'neon-blue': '#fdbd16',         // Now uses brand-gold
                        'neon-purple': '#f22524',       // Now uses brand-red
                        'neon-pink': '#FF4447',         // Light red variant
                        'neon-green': '#FEBD11',        // Gold for success
                        'neon-yellow': '#FFCF3A',       // Light gold
                    },
                    fontFamily: {
                        'gaming': ['Orbitron', 'sans-serif'],
                        'body': ['Rajdhani', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Brand Color Glow Animations */
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px rgba(254, 189, 17, 0.5), 0 0 20px rgba(243, 30, 33, 0.3); }
            50% { box-shadow: 0 0 20px rgba(254, 189, 17, 0.8), 0 0 40px rgba(243, 30, 33, 0.5); }
        }
        @keyframes pulse-glow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }
        
        /* Typography */
        .gaming-title { font-family: 'Orbitron', sans-serif; }
        .gaming-body { font-family: 'Rajdhani', sans-serif; }
        
        /* Brand Gradient Text - Gold to Red */
        .gradient-text { 
            background: linear-gradient(135deg, #FEBD11, #F31E21, #FEBD11); 
            background-size: 200% auto;
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            background-clip: text;
            animation: shimmer 3s linear infinite;
        }
        
        /* Brand Gradients for Backgrounds */
        .gradient-gold-red {
            background: linear-gradient(135deg, #FEBD11 0%, #F31E21 100%);
        }
        .gradient-black-gray {
            background: linear-gradient(135deg, #202020 0%, #585858 100%);
        }
        .gradient-gold-light {
            background: linear-gradient(135deg, #FEBD11 0%, #FFCF3A 100%);
        }
        .card-glow { animation: glow 3s infinite; }
        .slide-in { animation: slideIn 0.5s ease-out; }
        
        /* Enhanced Verification Styles */
        .filter-btn {
            transition: all 0.3s ease;
        }
        .filter-btn.active-filter {
            background: rgba(254, 189, 17, 0.3) !important;
            border-color: rgba(254, 189, 17, 0.8) !important;
            color: #FEBD11 !important;
            box-shadow: 0 0 10px rgba(254, 189, 17, 0.3);
        }
        .table-row {
            transition: all 0.3s ease;
        }
        .table-row:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        /* Notification Animation */
        .notification-enter {
            animation: slideInRight 0.3s ease-out;
        }
        .notification-exit {
            animation: slideOutRight 0.3s ease-in;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        /* Pulse animation for new submissions */
        .new-submission {
            animation: pulse-highlight 2s ease-in-out;
        }
        
        @keyframes pulse-highlight {
            0%, 100% { background-color: rgba(59, 130, 246, 0.1); }
            50% { background-color: rgba(59, 130, 246, 0.3); }
        }

        /* Professional notification animations */
        @keyframes shrink {
            from { width: 100%; }
            to { width: 0%; }
        }
        
        .animate-shrink {
            animation: shrink linear;
        }

        /* Enhanced notification styles */
        .notification-backdrop {
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }
        
        .admin-bg {
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0a0e27 100%);
            position: relative;
            min-height: 100vh;
        }
        .admin-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(0, 212, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 212, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: pulse-glow 4s infinite;
            pointer-events: none;
        }
        .table-row:hover {
            background: rgba(0, 212, 255, 0.1);
            transform: scale(1.01);
            transition: all 0.2s;
        }
    </style>
</head>
<body class="gaming-body admin-bg text-white">
    
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-gradient-to-br from-gaming-dark/95 to-purple-900/40 backdrop-blur-lg rounded-2xl border-2 border-neon-blue/30 p-8 w-full max-w-md card-glow slide-in">
            <div class="text-center mb-8">
                <div class="text-6xl mb-4 animate-pulse">‚öîÔ∏è</div>
                <h2 class="text-4xl font-black gaming-title gradient-text mb-2">COMMAND CENTER</h2>
                <p class="text-gray-400 gaming-body text-lg">Admin Access Required</p>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-bold text-neon-blue mb-2 gaming-title">USERNAME</label>
                <input id="loginUsername" class="w-full bg-black/50 border-2 border-neon-blue/30 focus:border-neon-purple rounded-xl px-4 py-3 text-white placeholder-gray-500 gaming-body focus:outline-none transition-all focus:shadow-lg focus:shadow-neon-blue/30" type="text" placeholder="Enter admin username">
            </div>
            
            <div class="mb-6">
                <label class="block text-sm font-bold text-neon-pink mb-2 gaming-title">PASSWORD</label>
                <input id="loginPassword" class="w-full bg-black/50 border-2 border-neon-pink/30 focus:border-neon-purple rounded-xl px-4 py-3 text-white placeholder-gray-500 gaming-body focus:outline-none transition-all focus:shadow-lg focus:shadow-neon-pink/30" type="password" placeholder="Enter admin password">
            </div>
            
            <!-- Server Status Indicator -->
            <div class="mb-6 bg-black/30 border border-brand-gold/30 rounded-xl p-4">
                <div class="text-xs font-bold text-brand-gold mb-3 gaming-title flex items-center gap-2">
                    <span class="animate-pulse">‚ö°</span> SERVERS STATUS
                </div>
                <div class="space-y-2 text-xs gaming-body">
                    <div class="flex justify-between items-center">
                        <span class="text-gray-400">Frontend Server:</span>
                        <span id="frontendStatus" class="flex items-center gap-1">
                            <span class="animate-pulse">üîÑ</span> 
                            <span class="text-gray-500">Checking...</span>
                        </span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-400">API Server:</span>
                        <span id="apiStatus" class="flex items-center gap-1">
                            <span class="animate-pulse">üîÑ</span> 
                            <span class="text-gray-500">Checking...</span>
                        </span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-400">Database:</span>
                        <span id="databaseStatus" class="flex items-center gap-1">
                            <span class="animate-pulse">üîÑ</span> 
                            <span class="text-gray-500">Checking...</span>
                        </span>
                    </div>
                </div>
            </div>
            
            <button class="w-full py-4 bg-gradient-to-r from-neon-blue to-neon-purple hover:from-neon-purple hover:to-neon-pink rounded-xl font-bold gaming-title text-lg transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-neon-purple/50" onclick="login()">
                üöÄ ACCESS COMMAND CENTER
            </button>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="hidden">
        <!-- Top Navigation -->
        <nav class="bg-gaming-dark/80 backdrop-blur-lg border-b-2 border-neon-blue/20 sticky top-0 z-50">
            <div class="container mx-auto px-2 sm:px-4 py-3 sm:py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2 sm:gap-4">
                        <span class="text-2xl sm:text-3xl">‚öîÔ∏è</span>
                        <div>
                            <h1 class="text-lg sm:text-2xl font-black gaming-title gradient-text">COMMAND CENTER</h1>
                            <p class="text-xs text-gray-400 hidden sm:block">Gaming Community Admin</p>
                        </div>
                    </div>
                    <button onclick="logout()" class="px-3 sm:px-4 py-2 bg-red-900/50 hover:bg-red-800 border border-red-500/50 rounded-lg gaming-title text-xs sm:text-sm transition-all hover:scale-105">
                        <span class="hidden sm:inline">üö™ LOGOUT</span>
                        <span class="sm:hidden">üö™</span>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="container mx-auto px-2 sm:px-4 py-4 sm:py-8">
            
            <!-- Navigation Tabs -->
            <div class="mb-6 sm:mb-8 flex flex-wrap gap-2">
                <button onclick="showSection('dashboard')" class="tab-btn px-3 sm:px-6 py-2 sm:py-3 bg-gradient-to-r from-neon-blue/20 to-neon-purple/20 border-2 border-neon-blue/50 rounded-xl gaming-title text-xs sm:text-sm font-bold hover:scale-105 transition-all" data-section="dashboard">
                    <span class="hidden sm:inline">üìä DASHBOARD</span>
                    <span class="sm:hidden">üìä</span>
                </button>
                <button onclick="showSection('users')" class="tab-btn px-3 sm:px-6 py-2 sm:py-3 bg-gaming-dark/50 border-2 border-gray-700 rounded-xl gaming-title text-xs sm:text-sm font-bold hover:border-neon-purple/50 hover:scale-105 transition-all" data-section="users">
                    <span class="hidden sm:inline">üë• PLAYERS</span>
                    <span class="sm:hidden">üë•</span>
                </button>
                <button onclick="showSection('tasks')" class="tab-btn px-3 sm:px-6 py-2 sm:py-3 bg-gaming-dark/50 border-2 border-gray-700 rounded-xl gaming-title text-xs sm:text-sm font-bold hover:border-neon-purple/50 hover:scale-105 transition-all" data-section="tasks">
                    <span class="hidden sm:inline">‚öîÔ∏è QUESTS</span>
                    <span class="sm:hidden">‚öîÔ∏è</span>
                </button>
                <button onclick="showSection('rewards')" class="tab-btn px-3 sm:px-6 py-2 sm:py-3 bg-gaming-dark/50 border-2 border-gray-700 rounded-xl gaming-title text-xs sm:text-sm font-bold hover:border-neon-purple/50 hover:scale-105 transition-all" data-section="rewards">
                    <span class="hidden sm:inline">üíé LOOT</span>
                    <span class="sm:hidden">üíé</span>
                </button>
                <button onclick="showSection('verification')" class="tab-btn px-3 sm:px-6 py-2 sm:py-3 bg-gaming-dark/50 border-2 border-gray-700 rounded-xl gaming-title text-xs sm:text-sm font-bold hover:border-neon-purple/50 hover:scale-105 transition-all" data-section="verification">
                    <span class="hidden sm:inline">‚úì VERIFICATION</span>
                    <span class="sm:hidden">‚úì</span>
                </button>
            </div>

            <!-- Server Status Panel (Dashboard) -->
            <div class="mb-6 bg-gradient-to-br from-gaming-dark/90 to-purple-900/20 border-2 border-brand-gold/30 rounded-2xl p-6 card-glow">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-3">
                        <span class="text-3xl animate-pulse">‚ö°</span>
                        <h3 class="text-xl sm:text-2xl font-black gaming-title text-brand-gold">SERVERS STATUS</h3>
                    </div>
                    <div class="text-xs text-gray-500 gaming-body">
                        Auto-refresh: 30s
                    </div>
                </div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                    <!-- Frontend Server -->
                    <div class="bg-black/30 border border-brand-gold/20 rounded-xl p-4">
                        <div class="text-xs text-gray-400 mb-2 gaming-body">Frontend Server</div>
                        <div id="dashboardFrontendStatus" class="flex items-center gap-2">
                            <span class="animate-pulse">üîÑ</span>
                            <div>
                                <div class="text-sm font-bold gaming-title text-gray-500">Checking...</div>
                                <div class="text-xs text-gray-600">Port 8080</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- API Server -->
                    <div class="bg-black/30 border border-brand-gold/20 rounded-xl p-4">
                        <div class="text-xs text-gray-400 mb-2 gaming-body">API Server</div>
                        <div id="dashboardApiStatus" class="flex items-center gap-2">
                            <span class="animate-pulse">üîÑ</span>
                            <div>
                                <div class="text-sm font-bold gaming-title text-gray-500">Checking...</div>
                                <div class="text-xs text-gray-600">Port 8000</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Database -->
                    <div class="bg-black/30 border border-brand-gold/20 rounded-xl p-4">
                        <div class="text-xs text-gray-400 mb-2 gaming-body">Database</div>
                        <div id="dashboardDatabaseStatus" class="flex items-center gap-2">
                            <span class="animate-pulse">üîÑ</span>
                            <div>
                                <div class="text-sm font-bold gaming-title text-gray-500">Checking...</div>
                                <div class="text-xs text-gray-600">PostgreSQL</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Auto-reload -->
                    <div class="bg-black/30 border border-brand-gold/20 rounded-xl p-4">
                        <div class="text-xs text-gray-400 mb-2 gaming-body">Auto-reload</div>
                        <div class="flex items-center gap-2">
                            <span class="text-green-400">‚úÖ</span>
                            <div>
                                <div class="text-sm font-bold gaming-title text-green-400">ENABLED</div>
                                <div class="text-xs text-gray-600">Code Changes</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Professional Admin Dashboard Section -->
            <section id="dashboard" class="content-section">
                <!-- Welcome Header -->
                <div class="bg-gradient-to-r from-brand-gold/10 to-brand-red/10 border-2 border-brand-gold/30 rounded-2xl p-6 mb-6">
                    <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4">
                        <div>
                            <h2 class="text-3xl font-black gaming-title gradient-text mb-2">üì° ADMIN COMMAND CENTER</h2>
                            <p class="text-gray-300 gaming-body text-lg">Welcome to the Gaming Hub Administration Panel</p>
                            <div class="flex items-center gap-4 mt-3 text-sm gaming-body">
                                <div class="flex items-center gap-2">
                                    <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                                    <span class="text-green-400">System Online</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-gray-400">Last Login:</span>
                                    <span class="text-brand-gold" id="lastLoginTime">Just now</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-gray-400">Session:</span>
                                    <span class="text-brand-gold" id="sessionDuration">00:00</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <div class="text-right">
                                <div class="text-sm text-gray-400 gaming-body">Admin Level</div>
                                <div class="text-xl font-bold gaming-title text-brand-gold">SUPER ADMIN</div>
                            </div>
                            <div class="w-12 h-12 bg-gradient-to-br from-brand-gold to-brand-red rounded-full flex items-center justify-center text-white font-bold gaming-title text-lg">
                                A
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Stats Overview -->
                <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-6">
                    <!-- Active Players -->
                    <div class="bg-gaming-dark/60 border-2 border-blue-500/30 rounded-xl p-6 hover:border-blue-400/50 transition-all cursor-pointer" onclick="showSection('users')">
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-blue-400 text-2xl">üë•</div>
                            <div class="text-xs text-blue-400 gaming-title bg-blue-500/20 px-2 py-1 rounded-full">+12 TODAY</div>
                        </div>
                        <div class="text-2xl font-bold gaming-title text-white mb-1" id="dashTotalUsers">0</div>
                        <div class="text-sm text-gray-400 gaming-body">Active Players</div>
                        <div class="text-xs text-blue-400 mt-2 gaming-body">Click to manage ‚Üí</div>
                    </div>

                    <!-- Active Quests -->
                    <div class="bg-gaming-dark/60 border-2 border-purple-500/30 rounded-xl p-6 hover:border-purple-400/50 transition-all cursor-pointer" onclick="showSection('tasks')">
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-purple-400 text-2xl">‚öîÔ∏è</div>
                            <div class="text-xs text-purple-400 gaming-title bg-purple-500/20 px-2 py-1 rounded-full">LIVE</div>
                        </div>
                        <div class="text-2xl font-bold gaming-title text-white mb-1" id="dashTotalQuests">0</div>
                        <div class="text-sm text-gray-400 gaming-body">Active Quests</div>
                        <div class="text-xs text-purple-400 mt-2 gaming-body">Click to manage ‚Üí</div>
                    </div>

                    <!-- Pending Verifications -->
                    <div class="bg-gaming-dark/60 border-2 border-cyan-500/30 rounded-xl p-6 hover:border-cyan-400/50 transition-all cursor-pointer" onclick="showSection('verification')">
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-cyan-400 text-2xl">‚úì</div>
                            <div class="text-xs text-cyan-400 gaming-title bg-cyan-500/20 px-2 py-1 rounded-full" id="dashPendingBadge">URGENT</div>
                        </div>
                        <div class="text-2xl font-bold gaming-title text-white mb-1" id="dashPendingVerifications">0</div>
                        <div class="text-sm text-gray-400 gaming-body">Pending Verifications</div>
                        <div class="text-xs text-cyan-400 mt-2 gaming-body">Click to verify ‚Üí</div>
                    </div>

                    <!-- Total Loot Items -->
                    <div class="bg-gaming-dark/60 border-2 border-brand-gold/30 rounded-xl p-6 hover:border-brand-gold/50 transition-all cursor-pointer" onclick="showSection('loot')">
                        <div class="flex items-center justify-between mb-4">
                            <div class="text-brand-gold text-2xl">üíé</div>
                            <div class="text-xs text-brand-gold gaming-title bg-brand-gold/20 px-2 py-1 rounded-full">CATALOG</div>
                        </div>
                        <div class="text-2xl font-bold gaming-title text-white mb-1" id="dashTotalLoot">0</div>
                        <div class="text-sm text-gray-400 gaming-body">Loot Items</div>
                        <div class="text-xs text-brand-gold mt-2 gaming-body">Click to manage ‚Üí</div>
                    </div>
                </div>

                <!-- Quick Actions Panel -->
                <div class="bg-gaming-dark/60 border-2 border-brand-red/30 rounded-2xl p-6 mb-6">
                    <h3 class="text-xl font-black gaming-title text-brand-red mb-6 flex items-center gap-2">
                        ‚ö° QUICK ACTIONS ACCESS
                        <div class="flex-1 h-px bg-gradient-to-r from-brand-red/50 to-transparent"></div>
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                        <!-- Create Quest -->
                        <button onclick="window.location.href='/quest-select.html'" class="group bg-purple-900/30 hover:bg-purple-900/50 border-2 border-purple-500/30 hover:border-purple-400/60 rounded-xl p-4 transition-all duration-300 hover:scale-105">
                            <div class="text-purple-400 text-3xl mb-3 group-hover:scale-110 transition-transform">‚öîÔ∏è</div>
                            <div class="font-bold gaming-title text-purple-300 mb-2">CREATE QUEST</div>
                            <div class="text-xs text-gray-400 gaming-body">Design new challenges</div>
                        </button>

                        <!-- Add Loot -->
                        <button onclick="showModal('rewardModal')" class="group bg-brand-gold/20 hover:bg-brand-gold/30 border-2 border-brand-gold/30 hover:border-brand-gold/60 rounded-xl p-4 transition-all duration-300 hover:scale-105">
                            <div class="text-brand-gold text-3xl mb-3 group-hover:scale-110 transition-transform">ÔøΩ</div>
                            <div class="font-bold gaming-title text-brand-gold mb-2">ADD LOOT</div>
                            <div class="text-xs text-gray-400 gaming-body">Create new rewards</div>
                        </button>

                        <!-- Verify Submissions -->
                        <button onclick="showSection('verification')" class="group bg-cyan-900/30 hover:bg-cyan-900/50 border-2 border-cyan-500/30 hover:border-cyan-400/60 rounded-xl p-4 transition-all duration-300 hover:scale-105">
                            <div class="text-cyan-400 text-3xl mb-3 group-hover:scale-110 transition-transform">‚úì</div>
                            <div class="font-bold gaming-title text-cyan-300 mb-2">VERIFY QUESTS</div>
                            <div class="text-xs text-gray-400 gaming-body">Process submissions</div>
                        </button>

                        <!-- Manage Players -->
                        <button onclick="showSection('users')" class="group bg-blue-900/30 hover:bg-blue-900/50 border-2 border-blue-500/30 hover:border-blue-400/60 rounded-xl p-4 transition-all duration-300 hover:scale-105">
                            <div class="text-blue-400 text-3xl mb-3 group-hover:scale-110 transition-transform">üë•</div>
                            <div class="font-bold gaming-title text-blue-300 mb-2">MANAGE PLAYERS</div>
                            <div class="text-xs text-gray-400 gaming-body">User administration</div>
                        </button>

                        <!-- System Monitor -->
                        <button onclick="showModal('systemStatusModal')" class="group bg-green-900/30 hover:bg-green-900/50 border-2 border-green-500/30 hover:border-green-400/60 rounded-xl p-4 transition-all duration-300 hover:scale-105">
                            <div class="text-green-400 text-3xl mb-3 group-hover:scale-110 transition-transform">üìä</div>
                            <div class="font-bold gaming-title text-green-300 mb-2">SYSTEM STATUS</div>
                            <div class="text-xs text-gray-400 gaming-body">Monitor health</div>
                        </button>

                        <!-- Analytics -->
                        <button onclick="showNotification('Analytics Dashboard', 'Advanced analytics coming in next update!', 'info')" class="group bg-orange-900/30 hover:bg-orange-900/50 border-2 border-orange-500/30 hover:border-orange-400/60 rounded-xl p-4 transition-all duration-300 hover:scale-105">
                            <div class="text-orange-400 text-3xl mb-3 group-hover:scale-110 transition-transform">üìà</div>
                            <div class="font-bold gaming-title text-orange-300 mb-2">ANALYTICS</div>
                            <div class="text-xs text-gray-400 gaming-body">Performance metrics</div>
                        </button>

                        <!-- Backup System -->
                        <button onclick="showNotification('Backup System', 'Automated backup system is running smoothly.', 'success')" class="group bg-indigo-900/30 hover:bg-indigo-900/50 border-2 border-indigo-500/30 hover:border-indigo-400/60 rounded-xl p-4 transition-all duration-300 hover:scale-105">
                            <div class="text-indigo-400 text-3xl mb-3 group-hover:scale-110 transition-transform">üíæ</div>
                            <div class="font-bold gaming-title text-indigo-300 mb-2">BACKUP</div>
                            <div class="text-xs text-gray-400 gaming-body">Data protection</div>
                        </button>

                        <!-- Settings -->
                        <button onclick="showNotification('Settings Panel', 'Advanced settings panel coming soon!', 'info')" class="group bg-gray-900/30 hover:bg-gray-900/50 border-2 border-gray-500/30 hover:border-gray-400/60 rounded-xl p-4 transition-all duration-300 hover:scale-105">
                            <div class="text-gray-400 text-3xl mb-3 group-hover:scale-110 transition-transform">‚öôÔ∏è</div>
                            <div class="font-bold gaming-title text-gray-300 mb-2">SETTINGS</div>
                            <div class="text-xs text-gray-400 gaming-body">System configuration</div>
                        </button>
                    </div>
                </div>

                <!-- Recent Activity Feed -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Recent Actions -->
                    <div class="bg-gaming-dark/60 border-2 border-gray-700/50 rounded-xl p-6">
                        <h3 class="text-lg font-black gaming-title text-gray-300 mb-4 flex items-center gap-2">
                            üìã RECENT ADMIN ACTIONS
                        </h3>
                        <div id="recentActions" class="space-y-3">
                            <div class="flex items-center gap-3 p-3 bg-gray-800/30 rounded-lg">
                                <div class="w-8 h-8 bg-purple-500/20 rounded-full flex items-center justify-center text-purple-400 text-sm">‚öîÔ∏è</div>
                                <div class="flex-1">
                                    <div class="text-sm font-medium text-gray-300 gaming-body">Quest "Twitter Follow" approved</div>
                                    <div class="text-xs text-gray-500">2 minutes ago</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 p-3 bg-gray-800/30 rounded-lg">
                                <div class="w-8 h-8 bg-brand-gold/20 rounded-full flex items-center justify-center text-brand-gold text-sm">üíé</div>
                                <div class="flex-1">
                                    <div class="text-sm font-medium text-gray-300 gaming-body">Loot "Golden Sword" created</div>
                                    <div class="text-xs text-gray-500">5 minutes ago</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 p-3 bg-gray-800/30 rounded-lg">
                                <div class="w-8 h-8 bg-cyan-500/20 rounded-full flex items-center justify-center text-cyan-400 text-sm">‚úì</div>
                                <div class="flex-1">
                                    <div class="text-sm font-medium text-gray-300 gaming-body">15 verifications processed</div>
                                    <div class="text-xs text-gray-500">10 minutes ago</div>
                                </div>
                            </div>
                        </div>
                        <button onclick="showNotification('Activity Log', 'Full activity log coming in next update!', 'info')" class="w-full mt-4 py-2 text-sm gaming-title text-gray-400 hover:text-gray-200 transition-colors border border-gray-600 rounded-lg hover:bg-gray-800/50">
                            View Full Log ‚Üí
                        </button>
                    </div>

                    <!-- System Performance -->
                    <div class="bg-gaming-dark/60 border-2 border-gray-700/50 rounded-xl p-6">
                        <h3 class="text-lg font-black gaming-title text-gray-300 mb-4 flex items-center gap-2">
                            üîß SYSTEM PERFORMANCE
                        </h3>
                        <div class="space-y-4">
                            <!-- API Response Time -->
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm text-gray-400 gaming-body">API Response Time</span>
                                    <span class="text-sm text-green-400 font-bold gaming-title">32ms</span>
                                </div>
                                <div class="w-full bg-gray-800 rounded-full h-2">
                                    <div class="bg-green-400 h-2 rounded-full" style="width: 85%"></div>
                                </div>
                            </div>
                            
                            <!-- Database Performance -->
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm text-gray-400 gaming-body">Database Health</span>
                                    <span class="text-sm text-green-400 font-bold gaming-title">Excellent</span>
                                </div>
                                <div class="w-full bg-gray-800 rounded-full h-2">
                                    <div class="bg-green-400 h-2 rounded-full" style="width: 92%"></div>
                                </div>
                            </div>

                            <!-- Active Connections -->
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm text-gray-400 gaming-body">Active Connections</span>
                                    <span class="text-sm text-blue-400 font-bold gaming-title">247</span>
                                </div>
                                <div class="w-full bg-gray-800 rounded-full h-2">
                                    <div class="bg-blue-400 h-2 rounded-full" style="width: 68%"></div>
                                </div>
                            </div>

                            <!-- Memory Usage -->
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm text-gray-400 gaming-body">Memory Usage</span>
                                    <span class="text-sm text-yellow-400 font-bold gaming-title">67%</span>
                                </div>
                                <div class="w-full bg-gray-800 rounded-full h-2">
                                    <div class="bg-yellow-400 h-2 rounded-full" style="width: 67%"></div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-green-900/20 border border-green-500/30 rounded-lg">
                            <div class="flex items-center gap-2">
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                                <span class="text-sm text-green-400 gaming-body font-medium">All systems operational</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Users Section -->
            <section id="users" class="content-section hidden">
                <div class="bg-gaming-dark/60 border-2 border-neon-blue/20 rounded-2xl p-3 sm:p-6">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 gap-2">
                        <h2 class="text-xl sm:text-2xl font-black gaming-title gradient-text">üë• PLAYER MANAGEMENT</h2>
                        <div class="text-xs sm:text-sm text-gray-400 gaming-body">Total Players: <span id="userCount" class="text-neon-blue font-bold">0</span></div>
                    </div>
                    
                    <!-- Desktop Table -->
                    <div class="hidden lg:block overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b-2 border-neon-blue/20">
                                    <th class="px-4 py-3 text-left text-neon-blue gaming-title text-sm">PLAYER</th>
                                    <th class="px-4 py-3 text-left text-neon-blue gaming-title text-sm">USERNAME</th>
                                    <th class="px-4 py-3 text-left text-neon-blue gaming-title text-sm">LEVEL</th>
                                    <th class="px-4 py-3 text-left text-neon-blue gaming-title text-sm">XP</th>
                                    <th class="px-4 py-3 text-left text-neon-blue gaming-title text-sm">EARNED</th>
                                    <th class="px-4 py-3 text-left text-neon-blue gaming-title text-sm">STATUS</th>
                                    <th class="px-4 py-3 text-left text-neon-blue gaming-title text-sm">ACTIONS</th>
                                </tr>
                            </thead>
                            <tbody id="usersTable" class="divide-y divide-gray-800">
                                <tr><td colspan="7" class="text-center py-12 text-gray-500">Loading players...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Mobile Card View -->
                    <div id="usersCards" class="lg:hidden space-y-3">
                        <div class="text-center py-8 text-gray-500">Loading players...</div>
                    </div>
                </div>
            </section>

            <!-- Tasks Section -->
            <section id="tasks" class="content-section hidden">
                <div class="bg-gaming-dark/60 border-2 border-neon-purple/20 rounded-2xl p-3 sm:p-6">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 gap-3">
                        <h2 class="text-xl sm:text-2xl font-black gaming-title gradient-text">‚öîÔ∏è QUEST MANAGEMENT</h2>
                        <button onclick="window.location.href='/quest-select.html'" class="w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 bg-gradient-to-r from-brand-gold to-brand-red hover:scale-105 rounded-xl gaming-title text-sm sm:text-base font-bold transition-all shadow-lg">
                            ‚ûï CREATE QUEST
                        </button>
                    </div>
                    
                    <!-- Desktop Table View -->
                    <div class="hidden lg:block overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b-2 border-neon-purple/20">
                                    <th class="px-4 py-3 text-left text-neon-purple gaming-title text-sm">QUEST</th>
                                    <th class="px-4 py-3 text-left text-neon-purple gaming-title text-sm">TYPE</th>
                                    <th class="px-4 py-3 text-left text-neon-purple gaming-title text-sm">PLATFORM</th>
                                    <th class="px-4 py-3 text-left text-neon-purple gaming-title text-sm">XP REWARD</th>
                                    <th class="px-4 py-3 text-left text-neon-purple gaming-title text-sm">RARITY</th>
                                    <th class="px-4 py-3 text-left text-neon-purple gaming-title text-sm">STATUS</th>
                                    <th class="px-4 py-3 text-left text-neon-purple gaming-title text-sm">ACTIONS</th>
                                </tr>
                            </thead>
                            <tbody id="tasksTable" class="divide-y divide-gray-800">
                                <tr><td colspan="7" class="text-center py-12 text-gray-500">Loading quests...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Mobile Card View -->
                    <div id="tasksCards" class="lg:hidden space-y-3">
                        <div class="text-center py-8 text-gray-500">Loading quests...</div>
                    </div>
                </div>
            </section>

            <!-- Rewards Section -->
            <section id="rewards" class="content-section hidden">
                <div class="bg-gaming-dark/60 border-2 border-neon-pink/20 rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-black gaming-title gradient-text">üíé LOOT MANAGEMENT</h2>
                        <button onclick="showAddRewardModal()" class="px-6 py-3 bg-gradient-to-r from-neon-purple to-neon-pink hover:from-neon-pink hover:to-neon-yellow rounded-xl gaming-title font-bold transition-all hover:scale-105 hover:shadow-lg hover:shadow-neon-pink/50">
                            ‚ûï ADD LOOT
                        </button>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b-2 border-neon-pink/20">
                                    <th class="px-4 py-3 text-left text-neon-pink gaming-title text-sm">LOOT</th>
                                    <th class="px-4 py-3 text-left text-neon-pink gaming-title text-sm">TYPE</th>
                                    <th class="px-4 py-3 text-left text-neon-pink gaming-title text-sm">XP COST</th>
                                    <th class="px-4 py-3 text-left text-neon-pink gaming-title text-sm">STOCK</th>
                                    <th class="px-4 py-3 text-left text-neon-pink gaming-title text-sm">CLAIMED</th>
                                    <th class="px-4 py-3 text-left text-neon-pink gaming-title text-sm">STATUS</th>
                                    <th class="px-4 py-3 text-left text-neon-pink gaming-title text-sm">ACTIONS</th>
                                </tr>
                            </thead>
                            <tbody id="rewardsTable" class="divide-y divide-gray-800">
                                <tr><td colspan="7" class="text-center py-12 text-gray-500">Loading loot...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Verification Section -->
            <section id="verification" class="content-section hidden">
                <div class="bg-gaming-dark/60 border-2 border-neon-green/20 rounded-2xl p-6">
                    <div class="flex flex-col lg:flex-row lg:items-center justify-between mb-6 gap-4">
                        <div>
                            <h2 class="text-2xl font-black gaming-title gradient-text">‚úì MISSION CONTROL - VERIFICATION QUEUE</h2>
                            <div class="text-sm text-gray-400 gaming-body mt-1">
                                Pending: <span id="verificationCount" class="text-neon-yellow font-bold">0</span> | 
                                Auto-refresh: <span class="text-neon-green">30s</span>
                            </div>
                        </div>
                        
                        <!-- Filter Controls -->
                        <div class="flex flex-wrap gap-2">
                            <button onclick="filterVerifications('all')" class="filter-btn active-filter px-3 py-1 bg-brand-gold/20 border border-brand-gold/50 rounded-lg text-brand-gold text-xs gaming-title hover:bg-brand-gold/30 transition-all">
                                ALL
                            </button>
                            <button onclick="filterVerifications('telegram')" class="filter-btn px-3 py-1 bg-blue-900/20 border border-blue-500/50 rounded-lg text-blue-400 text-xs gaming-title hover:bg-blue-900/30 transition-all">
                                TELEGRAM
                            </button>
                            <button onclick="filterVerifications('twitter')" class="filter-btn px-3 py-1 bg-purple-900/20 border border-purple-500/50 rounded-lg text-purple-400 text-xs gaming-title hover:bg-purple-900/30 transition-all">
                                TWITTER
                            </button>
                            <button onclick="filterVerifications('youtube')" class="filter-btn px-3 py-1 bg-red-900/20 border border-red-500/50 rounded-lg text-red-400 text-xs gaming-title hover:bg-red-900/30 transition-all">
                                YOUTUBE
                            </button>
                            <button onclick="filterVerifications('social')" class="filter-btn px-3 py-1 bg-pink-900/20 border border-pink-500/50 rounded-lg text-pink-400 text-xs gaming-title hover:bg-pink-900/30 transition-all">
                                SOCIAL
                            </button>
                            <button onclick="filterVerifications('high-xp')" class="filter-btn px-3 py-1 bg-brand-red/20 border border-brand-red/50 rounded-lg text-brand-red text-xs gaming-title hover:bg-brand-red/30 transition-all">
                                HIGH XP
                            </button>
                        </div>
                    </div>

                    <!-- Bulk Actions Bar -->
                    <div id="bulkActions" class="mb-4 p-3 bg-gray-900/50 border border-gray-700 rounded-lg" style="opacity: 0.5; pointer-events: none;">
                        <div class="flex flex-wrap items-center gap-3">
                            <span class="text-sm text-gray-400 gaming-body">Bulk Actions:</span>
                            <button onclick="bulkVerifyTasks(true)" class="px-4 py-2 bg-green-900/30 border border-green-500/50 rounded-lg text-green-400 text-sm gaming-title hover:bg-green-900/50 transition-all">
                                ‚úì APPROVE SELECTED
                            </button>
                            <button onclick="bulkVerifyTasks(false)" class="px-4 py-2 bg-red-900/30 border border-red-500/50 rounded-lg text-red-400 text-sm gaming-title hover:bg-red-900/50 transition-all">
                                ‚úó REJECT SELECTED
                            </button>
                            <button onclick="toggleAllTasks(true)" class="px-3 py-2 bg-blue-900/30 border border-blue-500/50 rounded-lg text-blue-400 text-sm gaming-title hover:bg-blue-900/50 transition-all">
                                SELECT ALL
                            </button>
                            <button onclick="toggleAllTasks(false)" class="px-3 py-2 bg-gray-900/30 border border-gray-500/50 rounded-lg text-gray-400 text-sm gaming-title hover:bg-gray-900/50 transition-all">
                                CLEAR
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b-2 border-neon-green/20">
                                    <th class="px-4 py-3 text-left text-neon-green gaming-title text-sm">
                                        <input type="checkbox" onchange="toggleAllTasks(this.checked)" class="rounded border-gray-600 bg-gray-800 text-neon-green focus:ring-2 focus:ring-neon-green">
                                    </th>
                                    <th class="px-4 py-3 text-left text-neon-green gaming-title text-sm">PLAYER</th>
                                    <th class="px-4 py-3 text-left text-neon-green gaming-title text-sm">QUEST</th>
                                    <th class="px-4 py-3 text-left text-neon-green gaming-title text-sm">XP REWARD</th>
                                    <th class="px-4 py-3 text-left text-neon-green gaming-title text-sm">PROOF</th>
                                    <th class="px-4 py-3 text-left text-neon-green gaming-title text-sm">SUBMITTED</th>
                                    <th class="px-4 py-3 text-left text-neon-green gaming-title text-sm">ACTIONS</th>
                                </tr>
                            </thead>
                            <tbody id="verificationTable" class="divide-y divide-gray-800">
                                <tr><td colspan="7" class="text-center py-12 text-gray-500">No pending verifications</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Stats Footer -->
                    <div class="mt-6 pt-4 border-t border-gray-700">
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                            <div class="bg-green-900/20 border border-green-500/30 rounded-lg p-3">
                                <div class="text-green-400 font-bold gaming-title text-lg" id="verifiedToday">0</div>
                                <div class="text-xs text-gray-400 gaming-body">Verified Today</div>
                            </div>
                            <div class="bg-red-900/20 border border-red-500/30 rounded-lg p-3">
                                <div class="text-red-400 font-bold gaming-title text-lg" id="rejectedToday">0</div>
                                <div class="text-xs text-gray-400 gaming-body">Rejected Today</div>
                            </div>
                            <div class="bg-blue-900/20 border border-blue-500/30 rounded-lg p-3">
                                <div class="text-blue-400 font-bold gaming-title text-lg" id="avgVerificationTime">0m</div>
                                <div class="text-xs text-gray-400 gaming-body">Avg. Processing</div>
                            </div>
                            <div class="bg-brand-gold/20 border border-brand-gold/30 rounded-lg p-3">
                                <div class="text-brand-gold font-bold gaming-title text-lg" id="totalXpAwarded">0</div>
                                <div class="text-xs text-gray-400 gaming-body">XP Awarded</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <!-- Task Modal -->
    <div id="taskModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-gradient-to-br from-gaming-dark to-purple-900/40 border-2 border-neon-purple/50 rounded-2xl p-8 w-full max-w-3xl card-glow max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-black gaming-title gradient-text">‚öîÔ∏è CREATE NEW QUEST</h2>
                <button onclick="closeModal('taskModal')" class="text-gray-400 hover:text-white text-3xl">&times;</button>
            </div>
            
            <form id="taskForm" onsubmit="submitTask(event)" class="space-y-4">
                <!-- Step 1: Choose Quest Type -->
                <div class="mb-6">
                    <label class="block text-neon-blue gaming-title text-sm mb-3">SELECT QUEST TYPE</label>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3">
                        <button type="button" onclick="selectQuestType('twitter')" class="quest-type-btn border-2 border-neon-blue/30 hover:border-neon-blue bg-black/50 rounded-xl p-4 text-center transition-all hover:scale-105" data-type="twitter">
                            <div class="text-3xl mb-2">üê¶</div>
                            <div class="text-sm gaming-title">Twitter</div>
                        </button>
                        <button type="button" onclick="selectQuestType('youtube')" class="quest-type-btn border-2 border-neon-blue/30 hover:border-neon-blue bg-black/50 rounded-xl p-4 text-center transition-all hover:scale-105" data-type="youtube">
                            <div class="text-3xl mb-2">üì∫</div>
                            <div class="text-sm gaming-title">YouTube</div>
                        </button>
                        <button type="button" onclick="selectQuestType('telegram')" class="quest-type-btn border-2 border-neon-blue/30 hover:border-neon-blue bg-black/50 rounded-xl p-4 text-center transition-all hover:scale-105" data-type="telegram">
                            <div class="text-3xl mb-2">‚úàÔ∏è</div>
                            <div class="text-sm gaming-title">Telegram</div>
                        </button>
                        <button type="button" onclick="selectQuestType('daily')" class="quest-type-btn border-2 border-neon-blue/30 hover:border-neon-blue bg-black/50 rounded-xl p-4 text-center transition-all hover:scale-105" data-type="daily">
                            <div class="text-3xl mb-2">üìÖ</div>
                            <div class="text-sm gaming-title">Daily Check-in</div>
                        </button>
                        <button type="button" onclick="selectQuestType('manual')" class="quest-type-btn border-2 border-neon-blue/30 hover:border-neon-blue bg-black/50 rounded-xl p-4 text-center transition-all hover:scale-105" data-type="manual">
                            <div class="text-3xl mb-2">‚úçÔ∏è</div>
                            <div class="text-sm gaming-title">Manual</div>
                        </button>
                    </div>
                </div>

                <!-- Common Fields -->
                <div class="space-y-4 common-fields" style="display: none;">
                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">QUEST TITLE</label>
                        <input id="taskTitle" type="text" required class="w-full bg-black/50 border-2 border-neon-blue/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                    </div>
                    
                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">DESCRIPTION</label>
                        <textarea id="taskDescription" rows="3" required class="w-full bg-black/50 border-2 border-neon-blue/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple"></textarea>
                    </div>

                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">XP REWARD</label>
                        <input id="taskPoints" type="number" required min="1" value="50" class="w-full bg-black/50 border-2 border-neon-blue/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                    </div>
                </div>

                <!-- Twitter Specific Fields -->
                <div id="twitterFields" class="hidden border-2 border-neon-blue/30 rounded-xl p-5 bg-blue-900/20 space-y-4">
                    <h3 class="text-lg font-bold gaming-title text-neon-blue mb-3">üê¶ Twitter Quest Configuration</h3>
                    
                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">ACTION TYPE</label>
                        <select id="twitterActionType" class="w-full bg-black/50 border-2 border-neon-blue/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                            <option value="follow">Follow Account</option>
                            <option value="like">Like Tweet</option>
                            <option value="retweet">Retweet</option>
                            <option value="reply">Reply to Tweet</option>
                        </select>
                    </div>

                    <div id="twitterUsernameField">
                        <label class="block text-neon-blue gaming-title text-sm mb-2">TARGET USERNAME (without @)</label>
                        <input id="twitterUsername" type="text" placeholder="username" class="w-full bg-black/50 border-2 border-neon-blue/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                        <p class="text-xs text-gray-400 mt-1">Example: elonmusk</p>
                    </div>

                    <div id="twitterTweetField" class="hidden">
                        <label class="block text-neon-blue gaming-title text-sm mb-2">TWEET URL</label>
                        <input id="twitterTweetUrl" type="url" placeholder="https://twitter.com/username/status/123456" class="w-full bg-black/50 border-2 border-neon-blue/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                    </div>

                    <div class="p-3 bg-neon-blue/10 border border-neon-blue/30 rounded-lg">
                        <p class="text-sm text-gray-300">
                            ‚ö° <strong>Auto-Verification:</strong> Uses Twitter API to verify completion (Rate limited: 100 checks/day)
                        </p>
                    </div>
                </div>

                <!-- Telegram Specific Fields -->
                <div id="telegramFields" class="hidden border-2 border-cyan-500/30 rounded-xl p-5 bg-cyan-900/20 space-y-4">
                    <h3 class="text-lg font-bold gaming-title text-cyan-400 mb-3">‚úàÔ∏è Telegram Quest Configuration</h3>
                    
                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">ACTION TYPE</label>
                        <select id="telegramActionType" class="w-full bg-black/50 border-2 border-cyan-500/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                            <option value="join_group">Join Group/Supergroup</option>
                            <option value="join_channel">Subscribe to Channel</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">TELEGRAM LINK</label>
                        <input id="telegramLink" type="url" placeholder="https://t.me/yourgroupname or @yourgroupname" class="w-full bg-black/50 border-2 border-cyan-500/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                        <p class="text-xs text-gray-400 mt-1">Example: https://t.me/mychannel or @mychannel</p>
                    </div>

                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">GROUP/CHANNEL ID</label>
                        <input id="telegramChatId" type="text" placeholder="-1001234567890 or @channelname" class="w-full bg-black/50 border-2 border-cyan-500/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                        <p class="text-xs text-gray-400 mt-1">Numeric ID (e.g., -1001234567890) or username (e.g., @mychannel)</p>
                    </div>

                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">GROUP/CHANNEL NAME</label>
                        <input id="telegramChatName" type="text" placeholder="My Awesome Channel" class="w-full bg-black/50 border-2 border-cyan-500/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                        <p class="text-xs text-gray-400 mt-1">Display name for users</p>
                    </div>

                    <div class="p-3 bg-cyan-500/10 border border-cyan-500/30 rounded-lg">
                        <p class="text-sm text-gray-300">
                            ‚ö° <strong>Auto-Verification:</strong> Bot checks if user is a member of the specified group/channel
                        </p>
                        <p class="text-xs text-gray-400 mt-2">
                            ‚ö†Ô∏è <strong>Requirements:</strong>
                            <br>‚Ä¢ Bot must be admin in the group/channel
                            <br>‚Ä¢ Group/channel must be public or bot must have access
                            <br>‚Ä¢ Bot needs permission to see member list
                        </p>
                    </div>
                </div>

                <!-- YouTube Specific Fields -->
                <div id="youtubeFields" class="hidden border-2 border-red-500/30 rounded-xl p-5 bg-red-900/20 space-y-4">
                    <h3 class="text-lg font-bold gaming-title text-red-400 mb-3">üì∫ YouTube Video Quest</h3>
                    
                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">YOUTUBE VIDEO URL</label>
                        <input id="youtubeUrl" type="url" placeholder="https://youtube.com/watch?v=..." class="w-full bg-black/50 border-2 border-red-500/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                    </div>

                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">SECRET CODE (shown in video)</label>
                        <input id="youtubeSecretCode" type="text" placeholder="e.g., QUEST2025" class="w-full bg-black/50 border-2 border-red-500/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                        <p class="text-xs text-gray-400 mt-1">Users must enter this code after watching</p>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-neon-blue gaming-title text-sm mb-2">MIN. WATCH TIME (seconds)</label>
                            <input id="youtubeMinWatchTime" type="number" value="120" min="30" max="3600" class="w-full bg-black/50 border-2 border-red-500/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                        </div>
                        
                        <div>
                            <label class="block text-neon-blue gaming-title text-sm mb-2">MAX ATTEMPTS</label>
                            <input id="youtubeMaxAttempts" type="number" value="3" min="1" max="10" class="w-full bg-black/50 border-2 border-red-500/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                        </div>
                    </div>

                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">CODE APPEARS AT</label>
                        <input id="youtubeCodeHint" type="text" placeholder="e.g., 2:30 or at the end" value="during the video" class="w-full bg-black/50 border-2 border-red-500/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                    </div>

                    <div class="p-3 bg-red-500/10 border border-red-500/30 rounded-lg">
                        <p class="text-sm text-gray-300">
                            ‚ö° <strong>How it works:</strong> User watches video, enters code shown in video. Watch time is tracked.
                        </p>
                    </div>
                </div>

                <!-- Daily Check-in Fields -->
                <div id="dailyFields" class="hidden border-2 border-neon-green/30 rounded-xl p-5 bg-green-900/20 space-y-4">
                    <h3 class="text-lg font-bold gaming-title text-neon-green mb-3">üìÖ Daily Check-in Quest</h3>
                    
                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">STREAK BONUS</label>
                        <select id="dailyStreakBonus" class="w-full bg-black/50 border-2 border-neon-green/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                            <option value="none">No Streak Bonus</option>
                            <option value="multiply">Multiply by Streak (Day 7 = 7x points)</option>
                            <option value="milestone">Milestone Bonuses (Day 7, 30, 100)</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">RESET TIME (UTC)</label>
                        <input id="dailyResetTime" type="time" value="00:00" class="w-full bg-black/50 border-2 border-neon-green/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                        <p class="text-xs text-gray-400 mt-1">When the daily quest resets</p>
                    </div>

                    <div>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input id="dailyStreakRequired" type="checkbox" class="w-5 h-5 rounded border-2 border-neon-green/50 bg-black/50">
                            <span class="text-sm gaming-body">Require consecutive days (break streak if missed)</span>
                        </label>
                    </div>

                    <div class="p-3 bg-neon-green/10 border border-neon-green/30 rounded-lg">
                        <p class="text-sm text-gray-300">
                            ‚ö° <strong>Auto-Completion:</strong> Simple button click. Users can complete once per day.
                        </p>
                    </div>
                </div>

                <!-- Manual Quest Fields -->
                <div id="manualFields" class="hidden border-2 border-neon-purple/30 rounded-xl p-5 bg-purple-900/20 space-y-4">
                    <h3 class="text-lg font-bold gaming-title text-neon-purple mb-3">‚úçÔ∏è Manual Verification Quest</h3>
                    
                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">QUEST URL (Optional)</label>
                        <input id="manualUrl" type="url" placeholder="https://..." class="w-full bg-black/50 border-2 border-neon-purple/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                        <p class="text-xs text-gray-400 mt-1">Link to instructions or external platform</p>
                    </div>

                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">SUBMISSION TYPE</label>
                        <select id="manualSubmissionType" class="w-full bg-black/50 border-2 border-neon-purple/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                            <option value="none">No Submission Needed</option>
                            <option value="text">Text/Link Submission</option>
                            <option value="screenshot">Screenshot Upload</option>
                            <option value="code">Enter Code</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-neon-blue gaming-title text-sm mb-2">INSTRUCTIONS FOR USERS</label>
                        <textarea id="manualInstructions" rows="3" placeholder="Tell users exactly what they need to do..." class="w-full bg-black/50 border-2 border-neon-purple/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple"></textarea>
                    </div>

                    <div class="p-3 bg-neon-purple/10 border border-neon-purple/30 rounded-lg">
                        <p class="text-sm text-gray-300">
                            ‚ö° <strong>Admin Review:</strong> Users submit quest completion. Admin manually approves/rejects.
                        </p>
                    </div>
                </div>

                <!-- Hidden Fields -->
                <input type="hidden" id="taskType" value="social">
                <input type="hidden" id="taskPlatform" value="">
                
                <button type="submit" id="submitQuestBtn" class="hidden w-full py-4 bg-gradient-to-r from-neon-purple to-neon-pink hover:from-neon-pink hover:to-neon-yellow rounded-xl gaming-title font-bold text-lg transition-all hover:scale-105">
                    üöÄ CREATE QUEST
                </button>
            </form>
        </div>
    </div>

    <!-- Reward Modal -->
    <div id="rewardModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-gradient-to-br from-gaming-dark to-purple-900/40 border-2 border-neon-pink/50 rounded-2xl p-8 w-full max-w-2xl card-glow">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-black gaming-title gradient-text">üíé ADD NEW LOOT</h2>
                <button onclick="closeModal('rewardModal')" class="text-gray-400 hover:text-white text-3xl">&times;</button>
            </div>
            
            <form id="rewardForm" onsubmit="submitReward(event)" class="space-y-4">
                <div>
                    <label class="block text-neon-pink gaming-title text-sm mb-2">LOOT TITLE</label>
                    <input id="rewardTitle" type="text" required class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                </div>
                
                <div>
                    <label class="block text-neon-pink gaming-title text-sm mb-2">DESCRIPTION</label>
                    <textarea id="rewardDescription" rows="3" required class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple"></textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-neon-pink gaming-title text-sm mb-2">TYPE</label>
                        <select id="rewardType" required class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                            <option value="digital">Digital</option>
                            <option value="physical">Physical</option>
                            <option value="voucher">Voucher</option>
                            <option value="special">Special</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-neon-pink gaming-title text-sm mb-2">XP COST</label>
                        <input id="rewardCost" type="number" required min="1" class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                    </div>
                </div>
                
                <div>
                    <label class="block text-neon-pink gaming-title text-sm mb-2">STOCK (leave empty for unlimited)</label>
                    <input id="rewardQuantity" type="number" min="1" class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                </div>
                
                <button type="submit" class="w-full py-4 bg-gradient-to-r from-neon-purple to-neon-pink hover:from-neon-pink hover:to-neon-yellow rounded-xl gaming-title font-bold text-lg transition-all hover:scale-105">
                    üíé ADD LOOT
                </button>
            </form>
        </div>
    </div>

    <!-- Edit Reward Modal -->
    <div id="editRewardModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-gradient-to-br from-gaming-dark to-purple-900/40 border-2 border-neon-pink/50 rounded-2xl p-8 w-full max-w-2xl card-glow">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-black gaming-title gradient-text">‚úèÔ∏è EDIT LOOT</h2>
                <button onclick="closeModal('editRewardModal')" class="text-gray-400 hover:text-white text-3xl">&times;</button>
            </div>
            
            <form id="editRewardForm" onsubmit="updateReward(event)" class="space-y-4">
                <input type="hidden" id="editRewardId">
                
                <div>
                    <label class="block text-neon-pink gaming-title text-sm mb-2">LOOT TITLE</label>
                    <input id="editRewardTitle" type="text" required class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                </div>
                
                <div>
                    <label class="block text-neon-pink gaming-title text-sm mb-2">DESCRIPTION</label>
                    <textarea id="editRewardDescription" rows="3" required class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple"></textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-neon-pink gaming-title text-sm mb-2">TYPE</label>
                        <select id="editRewardType" required class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                            <option value="digital">Digital</option>
                            <option value="physical">Physical</option>
                            <option value="voucher">Voucher</option>
                            <option value="special">Special</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-neon-pink gaming-title text-sm mb-2">XP COST</label>
                        <input id="editRewardCost" type="number" required min="1" class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-neon-pink gaming-title text-sm mb-2">STOCK (leave empty for unlimited)</label>
                        <input id="editRewardQuantity" type="number" min="1" class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                    </div>
                    
                    <div>
                        <label class="block text-neon-pink gaming-title text-sm mb-2">STATUS</label>
                        <select id="editRewardStatus" required class="w-full bg-black/50 border-2 border-neon-pink/30 rounded-xl px-4 py-3 text-white gaming-body focus:outline-none focus:border-neon-purple">
                            <option value="true">‚úì ACTIVE</option>
                            <option value="false">‚è∏ INACTIVE</option>
                        </select>
                    </div>
                </div>
                
                <div class="flex gap-4">
                    <button type="submit" class="flex-1 py-4 bg-gradient-to-r from-neon-purple to-neon-pink hover:from-neon-pink hover:to-neon-yellow rounded-xl gaming-title font-bold text-lg transition-all hover:scale-105">
                        ‚úèÔ∏è UPDATE LOOT
                    </button>
                    <button type="button" onclick="deleteReward()" class="px-6 py-4 bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900 rounded-xl gaming-title font-bold text-lg transition-all hover:scale-105">
                        ÔøΩ DEACTIVATE
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Configuration - API URL
        // Handle both localhost and GitHub Codespaces URLs
        let API_BASE;
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            // Local development
            API_BASE = window.location.origin.replace(':8080', ':8000');
        } else {
            // GitHub Codespaces - replace 8080 port in URL
            API_BASE = window.location.origin.replace('-8080.', '-8000.');
        }
        const API_URL = `${API_BASE}/api`;
        let authToken = null;
        
        console.log('Admin API_URL configured:', API_URL);

        // Check Server Status
        async function checkServerStatus() {
            // Helper function to update both login and dashboard status
            const updateStatus = (elementId, status, text, port = '') => {
                const loginElement = document.getElementById(elementId);
                const dashboardElement = document.getElementById('dashboard' + elementId.charAt(0).toUpperCase() + elementId.slice(1));
                
                if (loginElement) {
                    loginElement.innerHTML = `
                        <span class="text-${status === 'ok' ? 'green' : status === 'error' ? 'red' : 'gray'}-400">${status === 'ok' ? '‚úÖ' : status === 'error' ? '‚ùå' : '‚ö†Ô∏è'}</span> 
                        <span class="text-${status === 'ok' ? 'green' : status === 'error' ? 'red' : 'gray'}-400 font-bold">${text}</span>
                    `;
                }
                
                if (dashboardElement) {
                    dashboardElement.innerHTML = `
                        <span class="text-${status === 'ok' ? 'green' : status === 'error' ? 'red' : 'gray'}-400">${status === 'ok' ? '‚úÖ' : status === 'error' ? '‚ùå' : '‚ö†Ô∏è'}</span>
                        <div>
                            <div class="text-sm font-bold gaming-title text-${status === 'ok' ? 'green' : status === 'error' ? 'red' : 'gray'}-400">${text}</div>
                            ${port ? `<div class="text-xs text-gray-600">${port}</div>` : ''}
                        </div>
                    `;
                }
            };
            
            // Check Frontend Server (always running if this page loads)
            updateStatus('frontendStatus', 'ok', 'RUNNING', 'Port 8080');

            // Check API Server
            try {
                const apiResponse = await fetch(`${API_URL.replace('/api', '')}/`, { 
                    method: 'GET',
                    signal: AbortSignal.timeout(3000) // 3 second timeout
                });
                
                if (apiResponse.ok) {
                    updateStatus('apiStatus', 'ok', 'RUNNING', 'Port 8000');
                    
                    // Check Database (via users endpoint)
                    try {
                        const dbResponse = await fetch(`${API_URL}/users?limit=1`, {
                            signal: AbortSignal.timeout(3000)
                        });
                        
                        if (dbResponse.ok) {
                            updateStatus('databaseStatus', 'ok', 'CONNECTED', 'PostgreSQL');
                        } else {
                            throw new Error('Database check failed');
                        }
                    } catch (dbError) {
                        updateStatus('databaseStatus', 'error', 'OFFLINE', 'PostgreSQL');
                    }
                } else {
                    throw new Error('API not responding');
                }
            } catch (apiError) {
                updateStatus('apiStatus', 'error', 'OFFLINE', 'Port 8000');
                updateStatus('databaseStatus', 'warning', 'N/A', 'PostgreSQL');
            }
        }

        // Run status check on page load
        checkServerStatus();
        // Recheck every 30 seconds
        setInterval(checkServerStatus, 30000);

        // Handle authentication errors
        function handleAuthError() {
            console.error('Authentication failed - token expired or invalid');
            authToken = null;
            localStorage.removeItem('authToken');
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            alert('üîí Session expired! Please login again.');
        }

        // Login
        async function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            try {
                const response = await fetch(`${API_URL}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                if (!response.ok) throw new Error('Login failed');

                const data = await response.json();
                authToken = data.access_token;
                localStorage.setItem('authToken', authToken);

                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('adminDashboard').classList.remove('hidden');
                loadDashboard();
            } catch (error) {
                alert('‚ùå Login failed! Check credentials.');
                console.error(error);
            }
        }

        // Logout
        function logout() {
            authToken = null;
            localStorage.removeItem('authToken');
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
        }

        // Show section
        function showSection(sectionId) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.add('hidden'));
            document.getElementById(sectionId).classList.remove('hidden');
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.dataset.section === sectionId) {
                    btn.className = 'tab-btn px-6 py-3 bg-gradient-to-r from-neon-blue/20 to-neon-purple/20 border-2 border-neon-blue/50 rounded-xl gaming-title font-bold transition-all';
                } else {
                    btn.className = 'tab-btn px-6 py-3 bg-gaming-dark/50 border-2 border-gray-700 rounded-xl gaming-title font-bold hover:border-neon-purple/50 hover:scale-105 transition-all';
                }
            });

            // Load data for section
            if (sectionId === 'dashboard') loadDashboard();
            else if (sectionId === 'users') loadUsers();
            else if (sectionId === 'tasks') loadTasks();
            else if (sectionId === 'rewards') loadRewards();
            else if (sectionId === 'verification') loadVerification();
        }

        // Enhanced dashboard loading with real statistics
        async function loadDashboard() {
            try {
                // Start session timer
                startSessionTimer();
                
                // Load dashboard statistics
                await Promise.all([
                    loadDashboardStats(),
                    loadRecentActivity(),
                    loadSystemStatus()
                ]);
                
                // Auto-refresh dashboard every 30 seconds
                if (window.dashboardInterval) {
                    clearInterval(window.dashboardInterval);
                }
                window.dashboardInterval = setInterval(loadDashboardStats, 30000);
                
            } catch (error) {
                console.error('Dashboard loading error:', error);
                showNotification(
                    'Dashboard Loading Error',
                    'Unable to load dashboard statistics. Some data may not be current.',
                    'warning'
                );
            }
        }

        // Load dashboard statistics
        async function loadDashboardStats() {
            try {
                // Fetch data from multiple endpoints
                const [usersResponse, tasksResponse, verificationResponse, rewardsResponse] = await Promise.all([
                    fetch(`${API_URL}/users`, { headers: { 'Authorization': `Bearer ${authToken}` } }),
                    fetch(`${API_URL}/tasks`, { headers: { 'Authorization': `Bearer ${authToken}` } }),
                    fetch(`${API_URL}/admin/user-tasks?status=submitted`, { headers: { 'Authorization': `Bearer ${authToken}` } }),
                    fetch(`${API_URL}/rewards`, { headers: { 'Authorization': `Bearer ${authToken}` } })
                ]);

                const users = usersResponse.ok ? await usersResponse.json() : [];
                const tasks = tasksResponse.ok ? await tasksResponse.json() : [];
                const verifications = verificationResponse.ok ? await verificationResponse.json() : [];
                const rewards = rewardsResponse.ok ? await rewardsResponse.json() : [];

                // Update dashboard cards
                updateDashboardCard('dashTotalUsers', users.length, 'Active Players');
                updateDashboardCard('dashTotalQuests', tasks.filter(t => t.is_active).length, 'Active Quests');
                updateDashboardCard('dashPendingVerifications', verifications.length, 'Pending Verifications');
                updateDashboardCard('dashTotalLoot', rewards.filter(r => r.is_active).length, 'Loot Items');

                // Update pending verifications badge
                const pendingBadge = document.getElementById('dashPendingBadge');
                if (pendingBadge) {
                    if (verifications.length === 0) {
                        pendingBadge.textContent = 'CLEAR';
                        pendingBadge.className = 'text-xs text-green-400 gaming-title bg-green-500/20 px-2 py-1 rounded-full';
                    } else if (verifications.length > 10) {
                        pendingBadge.textContent = 'URGENT';
                        pendingBadge.className = 'text-xs text-red-400 gaming-title bg-red-500/20 px-2 py-1 rounded-full';
                    } else {
                        pendingBadge.textContent = 'PENDING';
                        pendingBadge.className = 'text-xs text-cyan-400 gaming-title bg-cyan-500/20 px-2 py-1 rounded-full';
                    }
                }

            } catch (error) {
                console.error('Error loading dashboard stats:', error);
            }
        }

        // Update dashboard card with animation
        function updateDashboardCard(elementId, value, description) {
            const element = document.getElementById(elementId);
            if (element) {
                const currentValue = parseInt(element.textContent) || 0;
                if (currentValue !== value) {
                    // Animate number change
                    animateValue(element, currentValue, value, 1000);
                }
            }
        }

        // Animate number values
        function animateValue(element, start, end, duration) {
            const startTimestamp = Date.now();
            const step = (timestamp) => {
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const current = Math.floor(progress * (end - start) + start);
                element.textContent = current.toLocaleString();
                if (progress < 1) {
                    requestAnimationFrame(step);
                }
            };
            requestAnimationFrame(step);
        }

        // Load recent activity (mock data for now)
        async function loadRecentActivity() {
            const activities = [
                { icon: '‚öîÔ∏è', color: 'purple', action: 'Quest "Twitter Follow" approved', time: '2 minutes ago' },
                { icon: 'üíé', color: 'brand-gold', action: 'Loot "Golden Sword" created', time: '5 minutes ago' },
                { icon: '‚úì', color: 'cyan', action: '15 verifications processed', time: '10 minutes ago' },
                { icon: 'üë•', color: 'blue', action: 'New player "GameMaster" registered', time: '15 minutes ago' },
                { icon: 'üõ°Ô∏è', color: 'green', action: 'System backup completed', time: '1 hour ago' }
            ];

            const container = document.getElementById('recentActions');
            if (container) {
                container.innerHTML = activities.map(activity => `
                    <div class="flex items-center gap-3 p-3 bg-gray-800/30 rounded-lg">
                        <div class="w-8 h-8 bg-${activity.color}-500/20 rounded-full flex items-center justify-center text-${activity.color}-400 text-sm">${activity.icon}</div>
                        <div class="flex-1">
                            <div class="text-sm font-medium text-gray-300 gaming-body">${activity.action}</div>
                            <div class="text-xs text-gray-500">${activity.time}</div>
                        </div>
                    </div>
                `).join('');
            }
        }

        // Load system status
        async function loadSystemStatus() {
            // Mock system performance data - in production this would come from monitoring APIs
            const performanceData = [
                { label: 'API Response Time', value: Math.floor(Math.random() * 50) + 20, unit: 'ms', max: 100, color: 'green' },
                { label: 'Database Health', value: Math.floor(Math.random() * 15) + 85, unit: '%', max: 100, color: 'green' },
                { label: 'Active Connections', value: Math.floor(Math.random() * 100) + 200, unit: '', max: 500, color: 'blue' },
                { label: 'Memory Usage', value: Math.floor(Math.random() * 30) + 50, unit: '%', max: 100, color: 'yellow' }
            ];

            // Update performance metrics if elements exist
            performanceData.forEach((metric, index) => {
                const percentage = (metric.value / metric.max) * 100;
                // This would update the performance bars in the dashboard
                console.log(`${metric.label}: ${metric.value}${metric.unit} (${percentage}%)`);
            });
        }

        // Session timer
        let sessionStartTime = null;
        function startSessionTimer() {
            if (!sessionStartTime) {
                sessionStartTime = Date.now();
                
                // Update login time
                const loginTimeElement = document.getElementById('lastLoginTime');
                if (loginTimeElement) {
                    loginTimeElement.textContent = new Date().toLocaleTimeString();
                }
            }

            // Update session duration every minute
            const updateSessionDuration = () => {
                if (!sessionStartTime) return;
                
                const duration = Date.now() - sessionStartTime;
                const minutes = Math.floor(duration / 60000);
                const seconds = Math.floor((duration % 60000) / 1000);
                
                const sessionElement = document.getElementById('sessionDuration');
                if (sessionElement) {
                    sessionElement.textContent = `${String(Math.floor(minutes / 60)).padStart(2, '0')}:${String(minutes % 60).padStart(2, '0')}`;
                }
            };

            // Update immediately and then every minute
            updateSessionDuration();
            setInterval(updateSessionDuration, 60000);
        }

        // System status modal helper
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('hidden');
            } else if (modalId === 'systemStatusModal') {
                // Create system status modal if it doesn't exist
                showNotification(
                    'System Status',
                    'All systems operational. API response: 32ms, Database health: Excellent, Memory usage: 67%',
                    'success',
                    { duration: 7000 }
                );
            }
        }

        // Load users
        async function loadUsers() {
            try {
                const response = await fetch(`${API_URL}/users`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const users = await response.json();
                
                document.getElementById('userCount').textContent = users.length;
                
                // Desktop table
                const tbody = document.getElementById('usersTable');
                tbody.innerHTML = users.map(user => `
                    <tr class="table-row">
                        <td class="px-4 py-4">
                            <div class="font-bold text-white gaming-body">${user.first_name || 'Unknown'} ${user.last_name || ''}</div>
                        </td>
                        <td class="px-4 py-4 text-gray-300 gaming-body">@${user.username || 'N/A'}</td>
                        <td class="px-4 py-4">
                            <span class="px-3 py-1 bg-neon-purple/20 border border-neon-purple/50 rounded-lg text-neon-purple gaming-title text-sm">
                                LVL ${Math.floor((user.total_points_earned || 0) / 100) + 1}
                            </span>
                        </td>
                        <td class="px-4 py-4 text-neon-green font-bold gaming-body">${user.points || 0}</td>
                        <td class="px-4 py-4 text-neon-blue font-bold gaming-body">${user.total_points_earned || 0}</td>
                        <td class="px-4 py-4">
                            <span class="px-3 py-1 ${user.is_banned ? 'bg-red-900/30 border-red-500/50 text-red-400' : 'bg-neon-green/20 border-neon-green/50 text-neon-green'} border rounded-lg gaming-title text-sm">
                                ${user.is_banned ? 'üö´ BANNED' : '‚úì ACTIVE'}
                            </span>
                        </td>
                        <td class="px-4 py-4">
                            <button onclick="toggleUserBan('${user.telegram_id}')" class="px-4 py-2 ${user.is_banned ? 'bg-neon-green/20 hover:bg-neon-green/30 border-neon-green/50' : 'bg-red-900/30 hover:bg-red-900/50 border-red-500/50'} border rounded-lg gaming-title text-sm transition-all hover:scale-105">
                                ${user.is_banned ? 'UNBAN' : 'BAN'}
                            </button>
                        </td>
                    </tr>
                `).join('');
                
                // Mobile cards
                const cardsContainer = document.getElementById('usersCards');
                cardsContainer.innerHTML = users.map(user => `
                    <div class="bg-gradient-to-br from-black/60 to-gray-900/40 border-2 ${user.is_banned ? 'border-red-500/30' : 'border-neon-blue/30'} rounded-xl p-3">
                        <!-- Header -->
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex-1 min-w-0">
                                <h3 class="text-white font-bold gaming-body text-sm truncate">${user.first_name || 'Unknown'} ${user.last_name || ''}</h3>
                                <p class="text-gray-400 text-xs gaming-body truncate">@${user.username || 'N/A'}</p>
                            </div>
                            <span class="px-2 py-1 ${user.is_banned ? 'bg-red-900/30 border-red-500/50 text-red-400' : 'bg-neon-green/20 border-neon-green/50 text-neon-green'} border rounded text-[10px] gaming-title whitespace-nowrap ml-2">
                                ${user.is_banned ? 'üö´' : '‚úì'}
                            </span>
                        </div>
                        
                        <!-- Stats Grid -->
                        <div class="grid grid-cols-3 gap-2 mb-2">
                            <div class="bg-neon-purple/10 border border-neon-purple/30 rounded-lg p-1.5 text-center">
                                <div class="text-[10px] text-gray-400 gaming-title mb-0.5">LVL</div>
                                <div class="text-neon-purple text-xs font-bold gaming-body">${Math.floor((user.total_points_earned || 0) / 100) + 1}</div>
                            </div>
                            <div class="bg-neon-green/10 border border-neon-green/30 rounded-lg p-1.5 text-center">
                                <div class="text-[10px] text-gray-400 gaming-title mb-0.5">XP</div>
                                <div class="text-neon-green text-xs font-bold gaming-body">${user.points || 0}</div>
                            </div>
                            <div class="bg-neon-blue/10 border border-neon-blue/30 rounded-lg p-1.5 text-center">
                                <div class="text-[10px] text-gray-400 gaming-title mb-0.5">TOTAL</div>
                                <div class="text-neon-blue text-xs font-bold gaming-body">${user.total_points_earned || 0}</div>
                            </div>
                        </div>
                        
                        <!-- Action -->
                        <button onclick="toggleUserBan('${user.telegram_id}')" class="w-full px-3 py-1.5 ${user.is_banned ? 'bg-neon-green/20 hover:bg-neon-green/30 border-neon-green/50' : 'bg-red-900/30 hover:bg-red-900/50 border-red-500/50'} border rounded-lg gaming-title text-xs transition-all">
                            ${user.is_banned ? '‚úÖ UNBAN' : 'üö´ BAN'}
                        </button>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading users:', error);
            }
        }

        // Load tasks
        async function loadTasks() {
            try {
                const response = await fetch(`${API_URL}/tasks`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const tasks = await response.json();
                
                // Desktop table view
                const tbody = document.getElementById('tasksTable');
                tbody.innerHTML = tasks.map(task => {
                    const rarityColors = {
                        'common': 'text-gray-400 border-gray-500/50',
                        'rare': 'text-neon-blue border-neon-blue/50',
                        'epic': 'text-neon-purple border-neon-purple/50',
                        'legendary': 'text-neon-yellow border-neon-yellow/50'
                    };
                    const rarity = task.points_reward < 50 ? 'common' : task.points_reward < 100 ? 'rare' : task.points_reward < 200 ? 'epic' : 'legendary';
                    
                    return `
                    <tr class="table-row">
                        <td class="px-4 py-4">
                            <div class="font-bold text-white gaming-body">${task.title}</div>
                            ${task.is_bonus ? '<span class="text-neon-yellow text-xs">‚≠ê BONUS</span>' : ''}
                        </td>
                        <td class="px-4 py-4 text-gray-300 gaming-body capitalize">${task.task_type || 'N/A'}</td>
                        <td class="px-4 py-4 text-gray-300 gaming-body capitalize">${task.platform || '‚Äî'}</td>
                        <td class="px-4 py-4 text-neon-green font-bold gaming-body">+${task.points_reward} XP</td>
                        <td class="px-4 py-4">
                            <span class="px-3 py-1 bg-black/30 border ${rarityColors[rarity]} rounded-lg gaming-title text-xs uppercase">
                                ${rarity}
                            </span>
                        </td>
                        <td class="px-4 py-4">
                            <span class="px-3 py-1 ${task.is_active ? 'bg-neon-green/20 border-neon-green/50 text-neon-green' : 'bg-gray-700/30 border-gray-600/50 text-gray-400'} border rounded-lg gaming-title text-sm">
                                ${task.is_active ? '‚úì ACTIVE' : '‚è∏ INACTIVE'}
                            </span>
                        </td>
                        <td class="px-4 py-4">
                            <div class="flex gap-2">
                                <button onclick="editTask('${task.id}')" class="px-3 py-2 bg-blue-900/30 hover:bg-blue-900/50 border border-blue-500/50 rounded-lg gaming-title text-xs transition-all hover:scale-105" title="Edit Quest">
                                    ‚úèÔ∏è EDIT
                                </button>
                                <button onclick="toggleTaskStatus('${task.id}', ${task.is_active})" class="px-3 py-2 ${task.is_active ? 'bg-yellow-900/30 hover:bg-yellow-900/50 border-yellow-500/50' : 'bg-green-900/30 hover:bg-green-900/50 border-green-500/50'} border rounded-lg gaming-title text-xs transition-all hover:scale-105" title="${task.is_active ? 'Deactivate' : 'Activate'} Quest">
                                    ${task.is_active ? '‚è∏' : '‚ñ∂Ô∏è'}
                                </button>
                                <button onclick="deleteTask('${task.id}')" class="px-3 py-2 bg-red-900/30 hover:bg-red-900/50 border border-red-500/50 rounded-lg gaming-title text-xs transition-all hover:scale-105" title="Delete Quest">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
                }).join('');
                
                // Mobile card view
                const cardsContainer = document.getElementById('tasksCards');
                cardsContainer.innerHTML = tasks.map(task => {
                    const rarityColors = {
                        'common': 'text-gray-400 border-gray-500/50 bg-gray-900/30',
                        'rare': 'text-neon-blue border-neon-blue/50 bg-blue-900/20',
                        'epic': 'text-neon-purple border-neon-purple/50 bg-purple-900/20',
                        'legendary': 'text-neon-yellow border-neon-yellow/50 bg-yellow-900/20'
                    };
                    const rarity = task.points_reward < 50 ? 'common' : task.points_reward < 100 ? 'rare' : task.points_reward < 200 ? 'epic' : 'legendary';
                    
                    return `
                    <div class="bg-gradient-to-br from-black/60 to-gray-900/40 border-2 ${task.is_active ? 'border-neon-purple/30' : 'border-gray-700/50'} rounded-xl p-3">
                        <!-- Header -->
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex-1 min-w-0">
                                <h3 class="text-white font-bold gaming-body text-sm mb-0.5 truncate">${task.title}</h3>
                                ${task.is_bonus ? '<span class="text-neon-yellow text-[10px]">‚≠ê</span>' : ''}
                            </div>
                            <span class="px-2 py-1 ${task.is_active ? 'bg-neon-green/20 border-neon-green/50 text-neon-green' : 'bg-gray-700/30 border-gray-600/50 text-gray-400'} border rounded text-[10px] gaming-title whitespace-nowrap ml-2">
                                ${task.is_active ? '‚úì' : '‚è∏'}
                            </span>
                        </div>
                        
                        <!-- Details Grid -->
                        <div class="grid grid-cols-4 gap-1.5 mb-2">
                            <div class="bg-black/30 border border-gray-700/50 rounded p-1.5 text-center">
                                <div class="text-[10px] text-gray-400 gaming-title mb-0.5">TYPE</div>
                                <div class="text-white gaming-body text-[10px] truncate" title="${task.task_type || 'N/A'}">${(task.task_type || 'N/A').substring(0, 8)}</div>
                            </div>
                            <div class="bg-black/30 border border-gray-700/50 rounded p-1.5 text-center">
                                <div class="text-[10px] text-gray-400 gaming-title mb-0.5">PLATFORM</div>
                                <div class="text-white gaming-body text-[10px] truncate" title="${task.platform || '‚Äî'}">${(task.platform || '‚Äî').substring(0, 8)}</div>
                            </div>
                            <div class="bg-neon-green/10 border border-neon-green/30 rounded p-1.5 text-center">
                                <div class="text-[10px] text-gray-400 gaming-title mb-0.5">XP</div>
                                <div class="text-neon-green font-bold gaming-body text-xs">+${task.points_reward}</div>
                            </div>
                            <div class="bg-black/30 border ${rarityColors[rarity].split(' ')[1]} rounded p-1.5 text-center">
                                <div class="text-[10px] ${rarityColors[rarity].split(' ')[0]} gaming-title">${rarity.toUpperCase()}</div>
                            </div>
                        </div>
                        
                        <!-- Actions -->
                        <div class="grid grid-cols-3 gap-1.5">
                            <button onclick="editTask('${task.id}')" class="px-2 py-1.5 bg-blue-900/30 hover:bg-blue-900/50 border border-blue-500/50 rounded gaming-title text-[10px] transition-all">
                                ‚úèÔ∏è
                            </button>
                            <button onclick="toggleTaskStatus('${task.id}', ${task.is_active})" class="px-2 py-1.5 ${task.is_active ? 'bg-yellow-900/30 hover:bg-yellow-900/50 border-yellow-500/50' : 'bg-green-900/30 hover:bg-green-900/50 border-green-500/50'} border rounded gaming-title text-[10px] transition-all">
                                ${task.is_active ? '‚è∏' : '‚ñ∂Ô∏è'}
                            </button>
                            <button onclick="deleteTask('${task.id}')" class="px-2 py-1.5 bg-red-900/30 hover:bg-red-900/50 border border-red-500/50 rounded gaming-title text-[10px] transition-all">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                `;
                }).join('');
            } catch (error) {
                console.error('Error loading tasks:', error);
            }
        }

        // Load rewards
        async function loadRewards() {
            try {
                const response = await fetch(`${API_URL}/rewards?active_only=false`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const rewards = await response.json();
                
                const tbody = document.getElementById('rewardsTable');
                tbody.innerHTML = rewards.map(reward => `
                    <tr class="table-row">
                        <td class="px-4 py-4">
                            <div class="font-bold text-white gaming-body">${reward.title}</div>
                        </td>
                        <td class="px-4 py-4 text-gray-300 gaming-body capitalize">${reward.reward_type || 'N/A'}</td>
                        <td class="px-4 py-4 text-neon-purple font-bold gaming-body">${reward.points_cost} XP</td>
                        <td class="px-4 py-4 text-neon-blue font-bold gaming-body">${reward.quantity_available || '‚àû'}</td>
                        <td class="px-4 py-4 text-neon-pink font-bold gaming-body">${reward.quantity_claimed || 0}</td>
                        <td class="px-4 py-4">
                            <span class="px-3 py-1 ${reward.is_active ? 'bg-neon-green/20 border-neon-green/50 text-neon-green' : 'bg-gray-700/30 border-gray-600/50 text-gray-400'} border rounded-lg gaming-title text-sm">
                                ${reward.is_active ? '‚úì ACTIVE' : '‚è∏ INACTIVE'}
                            </span>
                        </td>
                        <td class="px-4 py-4">
                            <button onclick="editReward('${reward.id}')" class="px-4 py-2 bg-neon-purple/20 hover:bg-neon-purple/30 border border-neon-purple/50 rounded-lg gaming-title text-sm transition-all hover:scale-105">
                                ‚úè EDIT
                            </button>
                        </td>
                    </tr>
                `).join('');
            } catch (error) {
                console.error('Error loading rewards:', error);
            }
        }

        // Enhanced load verification with better UI
        async function loadVerification() {
            try {
                const response = await fetch(`${API_URL}/admin/user-tasks?status=submitted`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const userTasks = await response.json();
                
                document.getElementById('verificationCount').textContent = userTasks.length;
                
                const tbody = document.getElementById('verificationTable');
                if (userTasks.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="7" class="text-center py-12 text-gray-500">üéâ No pending verifications! All caught up!</td></tr>';
                    return;
                }
                
                tbody.innerHTML = userTasks.map(ut => {
                    const submittedDate = new Date(ut.created_at);
                    const timeAgo = getTimeAgo(submittedDate);
                    const questType = getQuestTypeIcon(ut.tasks?.task_type || 'unknown');
                    const priorityClass = getPriorityClass(ut.tasks?.points_reward || 0);
                    
                    return `
                        <tr class="table-row hover:bg-gray-800/50 transition-all group">
                            <td class="px-4 py-4">
                                <input type="checkbox" name="task-select" value="${ut.id}" onchange="updateBulkActions()" class="rounded border-gray-600 bg-gray-800 text-neon-green focus:ring-2 focus:ring-neon-green">
                            </td>
                            <td class="px-4 py-4">
                                <div class="flex items-center gap-2">
                                    <div class="w-8 h-8 rounded-full bg-gradient-to-r from-brand-gold to-brand-red flex items-center justify-center text-white text-xs font-bold">
                                        ${(ut.users?.first_name || 'U')[0]}
                                    </div>
                                    <div>
                                        <div class="text-white font-bold gaming-body">${ut.users?.first_name || 'Unknown'}</div>
                                        ${ut.users?.username ? `<div class="text-xs text-gray-400">@${ut.users.username}</div>` : ''}
                                    </div>
                                </div>
                            </td>
                            <td class="px-4 py-4">
                                <div class="flex items-center gap-2">
                                    <span class="text-lg">${questType}</span>
                                    <div>
                                        <div class="text-gray-300 gaming-body font-medium">${ut.tasks?.title || 'Unknown Quest'}</div>
                                        <div class="text-xs text-gray-500 capitalize">${ut.tasks?.task_type || 'unknown'} quest</div>
                                    </div>
                                </div>
                            </td>
                            <td class="px-4 py-4">
                                <span class="px-3 py-1 rounded-full ${priorityClass} font-bold gaming-body text-sm">
                                    +${ut.tasks?.points_reward || 0} XP
                                </span>
                            </td>
                            <td class="px-4 py-4">
                                ${ut.proof_url ? 
                                    `<button onclick="viewProof('${ut.proof_url}', '${ut.tasks?.title || 'Quest'}')" class="text-neon-blue hover:text-neon-purple transition-colors flex items-center gap-1 text-sm gaming-body">
                                        üîó <span class="hidden sm:inline">View Proof</span>
                                    </button>` : 
                                    '<span class="text-gray-500 text-sm">No proof submitted</span>'
                                }
                                ${ut.submission_text ? 
                                    `<div class="text-xs text-gray-400 mt-1 max-w-xs truncate" title="${ut.submission_text}">
                                        üí¨ "${ut.submission_text}"
                                    </div>` : ''
                                }
                            </td>
                            <td class="px-4 py-4">
                                <div class="text-gray-400 text-sm gaming-body">${submittedDate.toLocaleDateString()}</div>
                                <div class="text-xs text-gray-500">${timeAgo}</div>
                            </td>
                            <td class="px-4 py-4">
                                <div class="flex gap-2">
                                    <button onclick="verifyTask('${ut.id}', true)" class="px-3 py-2 bg-green-900/30 hover:bg-green-900/50 border border-green-500/50 rounded-lg gaming-title text-xs text-green-400 transition-all hover:scale-105 flex items-center gap-1">
                                        ‚úì <span class="hidden sm:inline">APPROVE</span>
                                    </button>
                                    <button onclick="verifyWithReason('${ut.id}', false)" class="px-3 py-2 bg-red-900/30 hover:bg-red-900/50 border border-red-500/50 rounded-lg gaming-title text-xs text-red-400 transition-all hover:scale-105 flex items-center gap-1">
                                        ‚úó <span class="hidden sm:inline">REJECT</span>
                                    </button>
                                    <button onclick="viewTaskDetails('${ut.id}')" class="px-2 py-2 bg-blue-900/30 hover:bg-blue-900/50 border border-blue-500/50 rounded-lg text-blue-400 transition-all hover:scale-105">
                                        üëÅÔ∏è
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                }).join('');
                
                // Load verification stats
                loadVerificationStats();
                
            } catch (error) {
                console.error('Error loading verification:', error);
                showNotification(
                    'Verification Queue Loading Failed', 
                    'Unable to retrieve pending quest verifications. Please check your connection and try again.',
                    'error',
                    {
                        actionText: 'Retry Loading',
                        actionCallback: 'loadVerification()'
                    }
                );
            }
        }

        // Helper functions for enhanced verification UI
        function getTimeAgo(date) {
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMins / 60);
            const diffDays = Math.floor(diffHours / 24);
            
            if (diffMins < 60) return `${diffMins}m ago`;
            if (diffHours < 24) return `${diffHours}h ago`;
            return `${diffDays}d ago`;
        }

        function getQuestTypeIcon(type) {
            const icons = {
                'telegram': 'üí¨',
                'twitter': 'üê¶',
                'youtube': 'üì∫',
                'website': 'üåê',
                'social': 'üì±',
                'manual': '‚úçÔ∏è',
                'unknown': '‚ùì'
            };
            return icons[type] || icons.unknown;
        }

        function getPriorityClass(points) {
            if (points >= 200) return 'bg-red-900/30 border border-red-500/50 text-red-400';
            if (points >= 100) return 'bg-orange-900/30 border border-orange-500/50 text-orange-400';
            if (points >= 50) return 'bg-yellow-900/30 border border-yellow-500/50 text-yellow-400';
            return 'bg-green-900/30 border border-green-500/50 text-green-400';
        }

        // View proof in modal
        function viewProof(proofUrl, questTitle) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4';
            modal.onclick = (e) => e.target === modal && modal.remove();
            
            const isImage = /\.(jpg|jpeg|png|gif|webp)$/i.test(proofUrl);
            const isVideo = /\.(mp4|webm|ogg)$/i.test(proofUrl);
            
            modal.innerHTML = `
                <div class="bg-gaming-dark border-2 border-neon-green/50 rounded-xl max-w-4xl max-h-[90vh] overflow-hidden">
                    <div class="p-4 border-b border-gray-700 flex justify-between items-center">
                        <h3 class="text-lg font-bold gaming-title text-neon-green">üì∏ Proof for: ${questTitle}</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-xl">‚úï</button>
                    </div>
                    <div class="p-4 max-h-[70vh] overflow-auto">
                        ${isImage ? 
                            `<img src="${proofUrl}" alt="Quest Proof" class="max-w-full h-auto rounded-lg border border-gray-600">` :
                            isVideo ?
                            `<video src="${proofUrl}" controls class="max-w-full h-auto rounded-lg border border-gray-600"></video>` :
                            `<div class="text-center p-8">
                                <div class="text-4xl mb-4">üìÑ</div>
                                <p class="text-gray-300 mb-4">Cannot preview this file type</p>
                                <a href="${proofUrl}" target="_blank" class="px-4 py-2 bg-neon-blue/20 border border-neon-blue/50 rounded-lg text-neon-blue hover:bg-neon-blue/30 transition-all">
                                    üîó Open in New Tab
                                </a>
                            </div>`
                        }
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // View detailed task information
        function viewTaskDetails(userTaskId) {
            // Implementation for viewing detailed task info
            showNotification('üîç Task Details', 'Feature coming soon - detailed task analysis', 'info');
        }

        // Load verification statistics
        async function loadVerificationStats() {
            try {
                // These would be real API calls in production
                const today = new Date().toISOString().split('T')[0];
                
                // Mock stats for demo - replace with real API calls
                document.getElementById('verifiedToday').textContent = '12';
                document.getElementById('rejectedToday').textContent = '3';
                document.getElementById('avgVerificationTime').textContent = '4.2m';
                document.getElementById('totalXpAwarded').textContent = '2,450';
                
            } catch (error) {
                console.error('Error loading verification stats:', error);
            }
        }

        // Auto-refresh verification queue
        setInterval(() => {
            if (document.getElementById('verification').style.display !== 'none') {
                loadVerification();
            }
        }, 30000); // Refresh every 30 seconds

        // Submit task
        async function submitTask(event) {
            event.preventDefault();

            if (!selectedQuestType) {
                showNotification(
                    'Quest Type Required',
                    'Please select a quest type before submitting. Choose from the available quest categories above.',
                    'warning'
                );
                return;
            }

            // Base task payload
            const base = {
                title: document.getElementById('taskTitle').value,
                description: document.getElementById('taskDescription').value,
                platform: document.getElementById('taskPlatform').value || null,
                points_reward: parseInt(document.getElementById('taskPoints').value) || 0,
                is_bonus: false,
                is_active: true, // New quests are active by default
                url: null,
                verification_data: {}
            };

            // Determine task_type, verification_required and build verification_data
            let task_type = 'custom';
            let verification_required = true;

            if (selectedQuestType === 'twitter') {
                const actionType = document.getElementById('twitterActionType').value;
                const username = document.getElementById('twitterUsername').value.trim();

                if (!username) {
                    showNotification(
                        'Twitter Username Required',
                        'Please enter the target Twitter username that players need to follow.',
                        'warning'
                    );
                    return;
                }

                const twitterTypeMap = {
                    'follow': 'twitter_follow',
                    'like': 'twitter_like',
                    'retweet': 'twitter_retweet',
                    'reply': 'twitter_reply'
                };

                task_type = twitterTypeMap[actionType] || 'twitter_action';
                base.verification_data = { method: 'twitter_api', type: actionType, username };
                base.url = `https://twitter.com/${username}`;

                if (actionType !== 'follow') {
                    const tweetUrl = document.getElementById('twitterTweetUrl').value.trim();
                    if (!tweetUrl) {
                        showNotification(
                            'Tweet URL Required',
                            'Please enter the specific tweet URL for like/retweet/reply actions.',
                            'warning'
                        );
                        return;
                    }
                    base.url = tweetUrl;
                    const tweetIdMatch = tweetUrl.match(/status\/(\d+)/);
                    if (tweetIdMatch) base.verification_data.tweet_id = tweetIdMatch[1];
                }

            } else if (selectedQuestType === 'telegram') {
                const actionType = document.getElementById('telegramActionType').value;
                const telegramLink = document.getElementById('telegramLink').value.trim();
                const chatId = document.getElementById('telegramChatId').value.trim();
                const chatName = document.getElementById('telegramChatName').value.trim();

                if (!telegramLink) {
                    showNotification(
                        'Telegram Link Required',
                        'Please enter the Telegram group or channel invite link.',
                        'warning'
                    );
                    return;
                }
                if (!chatId) {
                    showNotification(
                        'Telegram Chat ID Required',
                        'Please enter the Group or Channel ID for verification purposes.',
                        'warning'
                    );
                    return;
                }
                if (!chatName) {
                    showNotification(
                        'Telegram Chat Name Required',
                        'Please enter the Group or Channel name for display purposes.',
                        'warning'
                    );
                    return;
                }

                const telegramTypeMap = {
                    'join_group': 'telegram_join_group',
                    'join_channel': 'telegram_join_channel'
                };

                task_type = telegramTypeMap[actionType] || 'telegram_action';
                base.url = telegramLink;
                base.verification_data = {
                    method: 'telegram_membership',
                    type: actionType,
                    chat_id: chatId,
                    chat_name: chatName,
                    invite_link: telegramLink
                };

            } else if (selectedQuestType === 'youtube') {
                const youtubeUrl = document.getElementById('youtubeUrl').value.trim();
                const secretCode = document.getElementById('youtubeSecretCode').value.trim();

                if (!youtubeUrl) { 
                    showNotification(
                        'YouTube Video URL Required',
                        'Please enter the YouTube video URL that players need to watch.',
                        'warning'
                    );
                    return; 
                }
                if (!secretCode) { 
                    showNotification(
                        'Secret Code Required',
                        'Please enter a secret code that will be revealed during the video for verification.',
                        'warning'
                    );
                    return; 
                }

                task_type = 'youtube_watch';
                base.url = youtubeUrl;
                base.verification_data = {
                    method: 'time_delay_code',
                    code: secretCode,
                    min_watch_time_seconds: parseInt(document.getElementById('youtubeMinWatchTime').value) || 120,
                    code_timestamp: document.getElementById('youtubeCodeHint').value || 'during the video',
                    max_attempts: parseInt(document.getElementById('youtubeMaxAttempts').value) || 3
                };

            } else if (selectedQuestType === 'daily') {
                const streakBonus = document.getElementById('dailyStreakBonus').value;
                const resetTime = document.getElementById('dailyResetTime').value;
                const streakRequired = document.getElementById('dailyStreakRequired').checked;

                task_type = 'daily_checkin';
                verification_required = false; // daily check-in is normally auto-complete
                base.verification_data = {
                    method: 'daily_checkin',
                    streak_bonus: streakBonus,
                    reset_time_utc: resetTime,
                    consecutive_required: streakRequired,
                    frequency: 'daily'
                };

            } else if (selectedQuestType === 'manual') {
                const submissionType = document.getElementById('manualSubmissionType').value;
                const instructions = document.getElementById('manualInstructions').value.trim();
                const manualUrl = document.getElementById('manualUrl').value.trim();

                task_type = 'manual_review';
                base.url = manualUrl || null;
                base.verification_data = {
                    method: 'manual_review',
                    submission_type: submissionType,
                    instructions: instructions,
                    requires_approval: true
                };
            }

            // Compose final payload
            const taskData = Object.assign({}, base, {
                task_type,
                verification_required
            });

            // Remove verification_data if empty
            if (!taskData.verification_data || Object.keys(taskData.verification_data).length === 0) {
                delete taskData.verification_data;
            }

            try {
                // Determine if we're creating or updating
                const isEditing = editingTaskId !== null;
                const url = isEditing ? `${API_URL}/tasks/${editingTaskId}` : `${API_URL}/tasks`;
                const method = isEditing ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(taskData)
                });

                if (response.ok) {
                    const emoji = {
                        'twitter': 'üê¶',
                        'telegram': '‚úàÔ∏è',
                        'youtube': 'üì∫',
                        'daily': 'üìÖ',
                        'manual': '‚úçÔ∏è'
                    }[selectedQuestType] || '‚öîÔ∏è';

                    const action = isEditing ? 'updated' : 'created';
                    const actionPast = isEditing ? 'Updated' : 'Created';
                    showNotification(
                        `Quest ${actionPast} Successfully`,
                        `The ${selectedQuestType} quest "${document.getElementById('taskTitle').value}" has been ${action} and is now ${isEditing ? 'updated' : 'available'} for players.`,
                        'success',
                        {
                            actionText: 'View Quests',
                            actionCallback: 'showSection("tasks")'
                        }
                    );
                    closeModal('taskModal');
                    loadTasks();
                    document.getElementById('taskForm').reset();
                    editingTaskId = null; // Reset edit mode
                } else {
                    if (response.status === 401) { handleAuthError(); return; }
                    const errorData = await response.json().catch(() => ({}));
                    const errorMessage = errorData.detail || errorData.message || `HTTP ${response.status}: ${response.statusText}`;
                    const action = isEditing ? 'update' : 'create';
                    console.error(`Failed to ${action} quest:`, errorMessage, errorData);
                    showNotification(
                        `Failed to ${action.charAt(0).toUpperCase() + action.slice(1)} Quest`,
                        `Unable to ${action} the ${selectedQuestType} quest. ${errorMessage}`,
                        'error'
                    );
                }
            } catch (error) {
                const action = editingTaskId ? 'updating' : 'creating';
                console.error(`Error ${action} task:`, error);
                showNotification(
                    'Network Connection Error',
                    'Unable to connect to the server while processing your quest. Please check your internet connection and try again.',
                    'error',
                    {
                        actionText: 'Retry',
                        actionCallback: 'submitTask()'
                    }
                );
            }
        }

        // Submit reward
        async function submitReward(event) {
            event.preventDefault();

            const rewardData = {
                title: document.getElementById('rewardTitle').value,
                description: document.getElementById('rewardDescription').value,
                reward_type: document.getElementById('rewardType').value,
                points_cost: parseInt(document.getElementById('rewardCost').value),
                quantity_available: document.getElementById('rewardQuantity').value ? 
                                   parseInt(document.getElementById('rewardQuantity').value) : null
            };

            try {
                const response = await fetch(`${API_URL}/rewards`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(rewardData)
                });

                if (response.ok) {
                    showNotification(
                        'Loot Created Successfully',
                        `${rewardData.title} has been added to the reward catalog and is now available for players to claim.`,
                        'loot',
                        {
                            actionText: 'View Catalog',
                            actionCallback: 'showSection("loot")'
                        }
                    );
                    closeModal('rewardModal');
                    loadRewards();
                    document.getElementById('rewardForm').reset();
                } else {
                    // Handle error response
                    const errorData = await response.json().catch(() => ({}));
                    const errorMessage = errorData.detail || errorData.message || `HTTP ${response.status}: ${response.statusText}`;
                    console.error('Failed to create reward:', errorMessage, errorData);
                    showNotification(
                        'Failed to Create Loot Item',
                        `Unable to add "${rewardData.title}" to the reward catalog. ${errorMessage}`,
                        'error'
                    );
                }
            } catch (error) {
                console.error('Error creating reward:', error);
                showNotification(
                    'Network Connection Error',
                    'Unable to connect to the server. Please check your internet connection and try again.',
                    'error',
                    {
                        actionText: 'Retry',
                        actionCallback: 'submitReward()'
                    }
                );
            }
        }

        // Edit reward function
        async function editReward(rewardId) {
            try {
                // Fetch all rewards and find the one we need
                const response = await fetch(`${API_URL}/rewards?active_only=false`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });

                if (!response.ok) {
                    throw new Error(`Failed to fetch rewards: ${response.status}`);
                }

                const rewards = await response.json();
                const reward = rewards.find(r => r.id === rewardId);
                
                if (!reward) {
                    throw new Error('Reward not found');
                }
                
                // Populate the edit form
                document.getElementById('editRewardId').value = reward.id;
                document.getElementById('editRewardTitle').value = reward.title;
                document.getElementById('editRewardDescription').value = reward.description;
                document.getElementById('editRewardType').value = reward.reward_type;
                document.getElementById('editRewardCost').value = reward.points_cost;
                document.getElementById('editRewardQuantity').value = reward.quantity_available || '';
                document.getElementById('editRewardStatus').value = reward.is_active.toString();

                // Show the edit modal
                document.getElementById('editRewardModal').classList.remove('hidden');
                
            } catch (error) {
                console.error('Error loading reward for edit:', error);
                showNotification('‚ùå Error', `Failed to load reward data: ${error.message}`, 'error');
            }
        }

        // Update reward function
        async function updateReward(event) {
            event.preventDefault();

            const rewardId = document.getElementById('editRewardId').value;
            const rewardData = {
                title: document.getElementById('editRewardTitle').value,
                description: document.getElementById('editRewardDescription').value,
                reward_type: document.getElementById('editRewardType').value,
                points_cost: parseInt(document.getElementById('editRewardCost').value),
                quantity_available: document.getElementById('editRewardQuantity').value ? 
                                   parseInt(document.getElementById('editRewardQuantity').value) : null,
                is_active: document.getElementById('editRewardStatus').value === 'true'
            };

            try {
                const response = await fetch(`${API_URL}/rewards/${rewardId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(rewardData)
                });

                if (response.ok) {
                    showNotification(
                        'Loot Item Updated Successfully', 
                        `Changes to "${rewardData.title}" have been saved and are now live for players.`,
                        'loot',
                        {
                            actionText: 'View Updated Item',
                            actionCallback: 'showSection("loot")'
                        }
                    );
                    closeModal('editRewardModal');
                    loadRewards();
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    const errorMessage = errorData.detail || errorData.message || `HTTP ${response.status}: ${response.statusText}`;
                    console.error('Failed to update reward:', errorMessage, errorData);
                    showNotification(
                        'Failed to Update Loot Item', 
                        `Unable to save changes to "${rewardData.title}". ${errorMessage}`,
                        'error'
                    );
                }
            } catch (error) {
                console.error('Error updating reward:', error);
                showNotification('‚ùå Network Error', `Failed to update reward: ${error.message}`, 'error');
            }
        }

        // Delete reward function (sets inactive instead of deleting)
        async function deleteReward() {
            const rewardId = document.getElementById('editRewardId').value;
            const rewardTitle = document.getElementById('editRewardTitle').value;
            
            if (!confirm(`üóëÔ∏è Are you sure you want to deactivate "${rewardTitle}"?\n\nThis will hide it from players but preserve the data.`)) {
                return;
            }

            try {
                // Get current reward data and set as inactive
                const currentData = {
                    title: document.getElementById('editRewardTitle').value,
                    description: document.getElementById('editRewardDescription').value,
                    reward_type: document.getElementById('editRewardType').value,
                    points_cost: parseInt(document.getElementById('editRewardCost').value),
                    quantity_available: document.getElementById('editRewardQuantity').value ? 
                                       parseInt(document.getElementById('editRewardQuantity').value) : null,
                    is_active: false  // Set as inactive
                };

                const response = await fetch(`${API_URL}/rewards/${rewardId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(currentData)
                });

                if (response.ok) {
                    showNotification('üóëÔ∏è Loot Deactivated', `"${rewardTitle}" has been hidden from the store.`, 'warning');
                    closeModal('editRewardModal');
                    loadRewards();
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    const errorMessage = errorData.detail || errorData.message || `HTTP ${response.status}: ${response.statusText}`;
                    console.error('Failed to deactivate reward:', errorMessage, errorData);
                    showNotification('‚ùå Deactivation Failed', `Error: ${errorMessage}`, 'error');
                }
            } catch (error) {
                console.error('Error deactivating reward:', error);
                showNotification('‚ùå Network Error', `Failed to deactivate reward: ${error.message}`, 'error');
            }
        }

        // Enhanced verification system
        async function verifyTask(userTaskId, approved, reason = '') {
            try {
                // Show loading state
                const approveBtn = document.querySelector(`button[onclick="verifyTask('${userTaskId}', true)"]`);
                const rejectBtn = document.querySelector(`button[onclick="verifyTask('${userTaskId}', false)"]`);
                
                if (approveBtn) approveBtn.innerHTML = approved ? '‚è≥ Processing...' : '‚úì APPROVE';
                if (rejectBtn) rejectBtn.innerHTML = !approved ? '‚è≥ Processing...' : '‚úó REJECT';
                
                const response = await fetch(`${API_URL}/admin/user-tasks/${userTaskId}/verify?approved=${approved}`, {
                    method: 'PUT',
                    headers: { 
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ reason: reason })
                });

                if (response.ok) {
                    if (approved) {
                        showNotification(
                            'Quest Verification Approved',
                            'The player has been awarded experience points and notified of the successful completion.',
                            'verification',
                            {
                                actionText: 'View Queue',
                                actionCallback: 'showSection("verification")'
                            }
                        );
                    } else {
                        showNotification(
                            'Quest Submission Rejected',
                            `The submission has been declined${reason ? ` with feedback: "${reason}"` : ''}. The player has been notified.`,
                            'warning',
                            {
                                duration: 6000
                            }
                        );
                    }
                    
                    // Remove row with animation
                    const row = document.querySelector(`button[onclick="verifyTask('${userTaskId}', true)"]`).closest('tr');
                    if (row) {
                        row.style.opacity = '0.5';
                        row.style.transform = 'translateX(-20px)';
                        setTimeout(() => loadVerification(), 300);
                    } else {
                        loadVerification();
                    }
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                console.error('Error verifying task:', error);
                showNotification(
                    'Verification Process Failed',
                    `Unable to process the quest verification. ${error.message}`,
                    'error',
                    {
                        actionText: 'Try Again',
                        actionCallback: `verifyTask('${userTaskId}', ${approved})`
                    }
                );
                
                // Reset button states
                const approveBtn = document.querySelector(`button[onclick="verifyTask('${userTaskId}', true)"]`);
                const rejectBtn = document.querySelector(`button[onclick="verifyTask('${userTaskId}', false)"]`);
                if (approveBtn) approveBtn.innerHTML = '‚úì APPROVE';
                if (rejectBtn) rejectBtn.innerHTML = '‚úó REJECT';
            }
        }

        // Advanced verification with reason dialog
        async function verifyWithReason(userTaskId, approved) {
            const action = approved ? 'approve' : 'reject';
            const reason = prompt(`${approved ? '‚úÖ Approve' : '‚ùå Reject'} this quest submission?\n\nOptional reason for player:`);
            
            if (reason === null) return; // User cancelled
            
            await verifyTask(userTaskId, approved, reason);
        }

        // Bulk verification actions
        async function bulkVerifyTasks(approved) {
            const checkboxes = document.querySelectorAll('input[name="task-select"]:checked');
            if (checkboxes.length === 0) {
                showNotification(
                    'No Tasks Selected', 
                    'Please select at least one quest submission before performing bulk actions.',
                    'warning'
                );
                return;
            }

            const action = approved ? 'approve' : 'reject';
            const confirmMsg = `${approved ? '‚úÖ Approve' : '‚ùå Reject'} ${checkboxes.length} selected quest(s)?`;
            
            if (!confirm(confirmMsg)) return;

            const results = { success: 0, failed: 0 };
            
            for (const checkbox of checkboxes) {
                try {
                    const userTaskId = checkbox.value;
                    const response = await fetch(`${API_URL}/admin/user-tasks/${userTaskId}/verify?approved=${approved}`, {
                        method: 'PUT',
                        headers: { 'Authorization': `Bearer ${authToken}` }
                    });
                    
                    if (response.ok) {
                        results.success++;
                    } else {
                        results.failed++;
                    }
                } catch (error) {
                    results.failed++;
                    console.error(`Error verifying task ${checkbox.value}:`, error);
                }
            }

            showNotification(
                'Bulk Verification Process Completed',
                `Successfully processed ${results.success} quest submission(s)${results.failed > 0 ? `, ${results.failed} operation(s) failed` : ''}. All players have been notified of the results.`,
                results.failed === 0 ? 'verification' : 'warning',
                {
                    duration: 7000,
                    actionText: 'View Queue',
                    actionCallback: 'showSection("verification")'
                }
            );
            
            loadVerification();
        }

        // Filter verification queue
        function filterVerifications(filterType) {
            const rows = document.querySelectorAll('#verificationTable tr');
            
            rows.forEach(row => {
                if (row.querySelector('td[colspan]')) return; // Skip "no data" row
                
                const questCell = row.children[1]?.textContent || '';
                const playerCell = row.children[0]?.textContent || '';
                
                let show = true;
                
                switch (filterType) {
                    case 'telegram':
                        show = questCell.toLowerCase().includes('telegram') || questCell.toLowerCase().includes('chat');
                        break;
                    case 'twitter':
                        show = questCell.toLowerCase().includes('twitter') || questCell.toLowerCase().includes('follow');
                        break;
                    case 'youtube':
                        show = questCell.toLowerCase().includes('youtube') || questCell.toLowerCase().includes('watch');
                        break;
                    case 'social':
                        show = questCell.toLowerCase().includes('social') || 
                               questCell.toLowerCase().includes('discord') ||
                               questCell.toLowerCase().includes('instagram');
                        break;
                    case 'high-xp':
                        const xpCell = row.children[2]?.textContent || '';
                        const xp = parseInt(xpCell.replace(/[^\d]/g, '')) || 0;
                        show = xp >= 100;
                        break;
                    case 'all':
                    default:
                        show = true;
                        break;
                }
                
                row.style.display = show ? '' : 'none';
            });
            
            // Update filter button states
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active-filter');
            });
            document.querySelector(`[onclick="filterVerifications('${filterType}')"]`)?.classList.add('active-filter');
        }

        // Professional notification system
        function showNotification(title, message, type = 'info', options = {}) {
            const {
                duration = 5000,
                persistent = false,
                actionText = null,
                actionCallback = null,
                position = 'top-right'
            } = options;

            const notification = document.createElement('div');
            const positionClass = getPositionClass(position);
            notification.className = `fixed ${positionClass} z-50 max-w-md w-full sm:w-auto min-w-[320px] mx-4 sm:mx-0 transform transition-all duration-500 ease-out ${getSlideInClass(position)} ${getNotificationClasses(type)}`;
            
            notification.innerHTML = `
                <div class="relative backdrop-blur-sm rounded-xl border shadow-2xl overflow-hidden">
                    <div class="absolute top-0 left-0 w-full h-1 ${getProgressBarClass(type)}"></div>
                    <div class="p-4">
                        <div class="flex items-start gap-3">
                            <div class="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${getIconBackgroundClass(type)}">
                                <span class="text-sm font-bold">${getNotificationIcon(type)}</span>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h4 class="font-bold gaming-title text-sm ${getTextColorClass(type)} leading-tight">${title}</h4>
                                <p class="text-sm gaming-body mt-1 text-gray-300 leading-relaxed">${message}</p>
                                ${actionText ? `
                                    <button onclick="${actionCallback || 'void(0)'}" class="mt-3 px-3 py-1 text-xs font-semibold gaming-title rounded-lg transition-all hover:scale-105 ${getActionButtonClass(type)}">
                                        ${actionText}
                                    </button>
                                ` : ''}
                            </div>
                            ${!persistent ? `
                                <button onclick="this.closest('.fixed').remove()" class="flex-shrink-0 p-1 text-gray-400 hover:text-white transition-colors rounded-full hover:bg-white/10">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                    ${!persistent && duration > 0 ? `
                        <div class="absolute bottom-0 left-0 h-1 ${getProgressBarClass(type)} animate-shrink" style="animation-duration: ${duration}ms;"></div>
                    ` : ''}
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove(getSlideInClass(position));
                notification.classList.add('scale-100', 'opacity-100');
            }, 50);
            
            // Auto remove
            if (!persistent && duration > 0) {
                setTimeout(() => {
                    notification.classList.add(getSlideOutClass(position));
                    setTimeout(() => notification.remove(), 500);
                }, duration);
            }
            
            return notification;
        }

        function getPositionClass(position) {
            switch (position) {
                case 'top-left': return 'top-4 left-4';
                case 'top-center': return 'top-4 left-1/2 transform -translate-x-1/2';
                case 'top-right': return 'top-4 right-4';
                case 'bottom-left': return 'bottom-4 left-4';
                case 'bottom-center': return 'bottom-4 left-1/2 transform -translate-x-1/2';
                case 'bottom-right': return 'bottom-4 right-4';
                default: return 'top-4 right-4';
            }
        }

        function getSlideInClass(position) {
            if (position.includes('left')) return 'translate-x-[-100%] opacity-0 scale-95';
            if (position.includes('right')) return 'translate-x-full opacity-0 scale-95';
            if (position.includes('top')) return 'translate-y-[-100%] opacity-0 scale-95';
            return 'translate-y-full opacity-0 scale-95';
        }

        function getSlideOutClass(position) {
            if (position.includes('left')) return 'translate-x-[-100%] opacity-0 scale-95';
            if (position.includes('right')) return 'translate-x-full opacity-0 scale-95';
            if (position.includes('top')) return 'translate-y-[-100%] opacity-0 scale-95';
            return 'translate-y-full opacity-0 scale-95';
        }

        function getNotificationClasses(type) {
            switch (type) {
                case 'success': return 'bg-emerald-950/95 border-emerald-500/30';
                case 'error': return 'bg-red-950/95 border-red-500/30';
                case 'warning': return 'bg-amber-950/95 border-amber-500/30';
                case 'loot': return 'bg-purple-950/95 border-purple-500/30';
                case 'verification': return 'bg-cyan-950/95 border-cyan-500/30';
                default: return 'bg-slate-950/95 border-slate-500/30';
            }
        }

        function getIconBackgroundClass(type) {
            switch (type) {
                case 'success': return 'bg-emerald-500/20 text-emerald-400';
                case 'error': return 'bg-red-500/20 text-red-400';
                case 'warning': return 'bg-amber-500/20 text-amber-400';
                case 'loot': return 'bg-purple-500/20 text-purple-400';
                case 'verification': return 'bg-cyan-500/20 text-cyan-400';
                default: return 'bg-slate-500/20 text-slate-400';
            }
        }

        function getTextColorClass(type) {
            switch (type) {
                case 'success': return 'text-emerald-300';
                case 'error': return 'text-red-300';
                case 'warning': return 'text-amber-300';
                case 'loot': return 'text-purple-300';
                case 'verification': return 'text-cyan-300';
                default: return 'text-slate-300';
            }
        }

        function getProgressBarClass(type) {
            switch (type) {
                case 'success': return 'bg-gradient-to-r from-emerald-500 to-emerald-400';
                case 'error': return 'bg-gradient-to-r from-red-500 to-red-400';
                case 'warning': return 'bg-gradient-to-r from-amber-500 to-amber-400';
                case 'loot': return 'bg-gradient-to-r from-purple-500 to-purple-400';
                case 'verification': return 'bg-gradient-to-r from-cyan-500 to-cyan-400';
                default: return 'bg-gradient-to-r from-slate-500 to-slate-400';
            }
        }

        function getActionButtonClass(type) {
            switch (type) {
                case 'success': return 'bg-emerald-600/30 border border-emerald-500/50 text-emerald-300 hover:bg-emerald-600/50';
                case 'error': return 'bg-red-600/30 border border-red-500/50 text-red-300 hover:bg-red-600/50';
                case 'warning': return 'bg-amber-600/30 border border-amber-500/50 text-amber-300 hover:bg-amber-600/50';
                case 'loot': return 'bg-purple-600/30 border border-purple-500/50 text-purple-300 hover:bg-purple-600/50';
                case 'verification': return 'bg-cyan-600/30 border border-cyan-500/50 text-cyan-300 hover:bg-cyan-600/50';
                default: return 'bg-slate-600/30 border border-slate-500/50 text-slate-300 hover:bg-slate-600/50';
            }
        }

        function getNotificationIcon(type) {
            switch (type) {
                case 'success': return '‚úì';
                case 'error': return '‚ö†';
                case 'warning': return '!';
                case 'loot': return 'üíé';
                case 'verification': return '‚úì';
                default: return '‚Ñπ';
            }
        }

        // Toggle all checkboxes
        function toggleAllTasks(selectAll) {
            const checkboxes = document.querySelectorAll('input[name="task-select"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAll;
            });
            updateBulkActions();
        }

        // Update bulk action button states
        function updateBulkActions() {
            const checkedCount = document.querySelectorAll('input[name="task-select"]:checked').length;
            const bulkContainer = document.getElementById('bulkActions');
            
            if (bulkContainer) {
                bulkContainer.style.opacity = checkedCount > 0 ? '1' : '0.5';
                bulkContainer.style.pointerEvents = checkedCount > 0 ? 'auto' : 'none';
            }
        }

        // Toggle user ban
        async function toggleUserBan(userId) {
            try {
                const response = await fetch(`${API_URL}/admin/users/${userId}/ban`, {
                    method: 'PUT',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });

                if (response.ok) {
                    alert('‚úì Player status updated!');
                    loadUsers();
                }
            } catch (error) {
                console.error('Error toggling user ban:', error);
            }
        }

        // Delete task
        async function deleteTask(taskId) {
            if (!confirm('‚ö†Ô∏è Delete this quest permanently?')) return;

            // Check if user is authenticated
            if (!authToken) {
                alert('‚ö†Ô∏è You are not logged in! Please refresh the page and log in again.');
                handleAuthError();
                return;
            }

            try {
                const response = await fetch(`${API_URL}/tasks/${taskId}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });

                if (response.ok) {
                    alert('üóë Quest deleted!');
                    loadTasks();
                } else if (response.status === 401) {
                    alert('üîí Session expired! Please log in again.');
                    handleAuthError();
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    const errorMessage = errorData.detail || errorData.message || `HTTP ${response.status}`;
                    alert(`‚ùå Failed to delete quest!\n\nError: ${errorMessage}`);
                }
            } catch (error) {
                console.error('Error deleting task:', error);
                alert(`‚ùå Network error: ${error.message}`);
            }
        }

        // Edit task
        let editingTaskId = null;
        
        async function editTask(taskId) {
            try {
                // First, fetch the quest to check its type
                const response = await fetch(`${API_URL}/tasks/${taskId}`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const quest = await response.json();
                    
                    // Check quest type and route to appropriate edit page
                    if (quest.task_type && quest.task_type.includes('telegram')) {
                        // Redirect to dedicated Telegram quest edit page
                        window.location.href = `edit-telegram-quest.html?id=${taskId}`;
                    } else if (quest.task_type && quest.task_type.includes('twitter') || quest.platform === 'twitter') {
                        // Redirect to dedicated Twitter quest edit page
                        window.location.href = `edit-twitter-quest.html?id=${taskId}`;
                    } else if (quest.task_type && quest.task_type.includes('youtube') || quest.platform === 'youtube') {
                        // Redirect to dedicated YouTube quest edit page
                        window.location.href = `edit-youtube-quest.html?id=${taskId}`;
                    } else if (quest.task_type && (quest.task_type.includes('visit') || quest.task_type.includes('website')) || quest.platform === 'website') {
                        // Redirect to dedicated Website quest edit page
                        window.location.href = `edit-website-quest.html?id=${taskId}`;
                    } else if (quest.task_type && (quest.task_type.includes('social') || quest.task_type.includes('manual')) || quest.platform === 'social') {
                        // Redirect to dedicated Social Media quest edit page
                        window.location.href = `edit-social-media-quest.html?id=${taskId}`;
                    } else {
                        // Redirect to general edit page for other quest types
                        window.location.href = `edit-quest.html?id=${taskId}`;
                    }
                } else {
                    // Fallback to general edit page if we can't determine type
                    window.location.href = `edit-quest.html?id=${taskId}`;
                }
            } catch (error) {
                console.error('Error checking quest type:', error);
                // Fallback to general edit page
                window.location.href = `edit-quest.html?id=${taskId}`;
            }
        }
        
        // Legacy edit function (kept for reference, not used)
        async function editTaskModal(taskId) {
            try {
                // Fetch task details
                const response = await fetch(`${API_URL}/tasks/${taskId}`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (!response.ok) throw new Error('Failed to fetch task');
                
                const task = await response.json();
                editingTaskId = taskId;
                
                // Show modal
                document.getElementById('taskModal').classList.remove('hidden');
                
                // Change modal title
                document.querySelector('#taskModal h2').textContent = '‚úèÔ∏è EDIT QUEST';
                document.getElementById('submitQuestBtn').textContent = 'üíæ UPDATE QUEST';
                
                // Pre-fill common fields
                document.getElementById('taskTitle').value = task.title || '';
                document.getElementById('taskDescription').value = task.description || '';
                document.getElementById('taskPoints').value = task.points_reward || 0;
                
                // Determine quest type and select it
                let questType = 'manual'; // default
                if (task.task_type) {
                    if (task.task_type.startsWith('twitter_')) {
                        questType = 'twitter';
                    } else if (task.task_type.startsWith('telegram_')) {
                        questType = 'telegram';
                    } else if (task.task_type === 'youtube_watch') {
                        questType = 'youtube';
                    } else if (task.task_type === 'daily_checkin') {
                        questType = 'daily';
                    } else if (task.task_type === 'manual_review') {
                        questType = 'manual';
                    }
                }
                
                // Select quest type
                selectQuestType(questType);
                
                // Pre-fill type-specific fields
                if (questType === 'twitter' && task.verification_data) {
                    const actionType = task.task_type.replace('twitter_', '');
                    document.getElementById('twitterActionType').value = actionType;
                    document.getElementById('twitterUsername').value = task.verification_data.username || '';
                    if (task.url) {
                        document.getElementById('twitterTweetUrl').value = task.url;
                    }
                    updateTwitterFields();
                } else if (questType === 'telegram' && task.verification_data) {
                    const actionType = task.task_type.replace('telegram_', '');
                    document.getElementById('telegramActionType').value = actionType;
                    document.getElementById('telegramLink').value = task.url || task.verification_data.invite_link || '';
                    document.getElementById('telegramChatId').value = task.verification_data.chat_id || '';
                    document.getElementById('telegramChatName').value = task.verification_data.chat_name || '';
                } else if (questType === 'youtube' && task.verification_data) {
                    document.getElementById('youtubeUrl').value = task.url || '';
                    document.getElementById('youtubeSecretCode').value = task.verification_data.code || '';
                    document.getElementById('youtubeMinWatchTime').value = task.verification_data.min_watch_seconds || 120;
                    document.getElementById('youtubeMaxAttempts').value = task.verification_data.max_attempts || 3;
                    document.getElementById('youtubeCodeHint').value = task.verification_data.code_hint || 'during the video';
                } else if (questType === 'daily' && task.verification_data) {
                    document.getElementById('dailyStreakBonus').value = task.verification_data.streak_bonus || 'none';
                    document.getElementById('dailyResetTime').value = task.verification_data.reset_time || '00:00';
                    document.getElementById('dailyStreakRequired').checked = task.verification_data.consecutive_required || false;
                } else if (questType === 'manual') {
                    document.getElementById('manualUrl').value = task.url || '';
                    if (task.verification_data) {
                        document.getElementById('manualSubmissionType').value = task.verification_data.submission_type || 'none';
                        document.getElementById('manualInstructions').value = task.verification_data.instructions || '';
                    }
                }
                
            } catch (error) {
                console.error('Error loading task for edit:', error);
                alert('‚ùå Failed to load quest details');
            }
        }

        // Toggle task active/inactive status
        async function toggleTaskStatus(taskId, currentStatus) {
            const newStatus = !currentStatus;
            
            if (!confirm(`${newStatus ? '‚ñ∂Ô∏è Activate' : '‚è∏ Deactivate'} this quest?`)) return;

            // Check if user is authenticated
            if (!authToken) {
                alert('‚ö†Ô∏è You are not logged in! Please refresh the page and log in again.');
                handleAuthError();
                return;
            }

            try {
                const response = await fetch(`${API_URL}/tasks/${taskId}/toggle`, {
                    method: 'PATCH',
                    headers: { 
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    const result = await response.json();
                    alert(`${result.is_active ? '‚úÖ Quest activated!' : '‚è∏ Quest deactivated!'}`);
                    loadTasks();
                } else if (response.status === 401) {
                    alert('üîí Session expired! Please log in again.');
                    handleAuthError();
                } else {
                    const error = await response.json().catch(() => ({}));
                    throw new Error(error.detail || 'Failed to update status');
                }
            } catch (error) {
                console.error('Error toggling task status:', error);
                alert(`‚ùå Failed to toggle quest status: ${error.message}`);
            }
        }

        // Modal functions
        let selectedQuestType = null;

        function showAddTaskModal() {
            document.getElementById('taskModal').classList.remove('hidden');
            
            // Reset edit mode
            editingTaskId = null;
            document.querySelector('#taskModal h2').textContent = '‚öîÔ∏è CREATE NEW QUEST';
            document.getElementById('submitQuestBtn').textContent = 'üöÄ CREATE QUEST';
            
            // Reset form
            document.getElementById('taskForm').reset();
            selectedQuestType = null;
            document.querySelectorAll('.quest-type-btn').forEach(btn => {
                btn.classList.remove('border-neon-purple', 'bg-neon-purple/20');
                btn.classList.add('border-neon-blue/30');
            });
            document.querySelectorAll('.common-fields, #twitterFields, #telegramFields, #youtubeFields, #dailyFields, #manualFields').forEach(el => el.style.display = 'none');
            document.getElementById('submitQuestBtn').classList.add('hidden');
        }

        function selectQuestType(type) {
            selectedQuestType = type;
            
            // Update button styles
            document.querySelectorAll('.quest-type-btn').forEach(btn => {
                if (btn.dataset.type === type) {
                    btn.classList.remove('border-neon-blue/30');
                    btn.classList.add('border-neon-purple', 'bg-neon-purple/20');
                } else {
                    btn.classList.remove('border-neon-purple', 'bg-neon-purple/20');
                    btn.classList.add('border-neon-blue/30');
                }
            });

            // Show common fields
            document.querySelector('.common-fields').style.display = 'block';
            
            // Hide all specific fields first
            document.querySelectorAll('#twitterFields, #telegramFields, #youtubeFields, #dailyFields, #manualFields').forEach(el => {
                el.classList.add('hidden');
            });

            // Show relevant fields
            if (type === 'twitter') {
                document.getElementById('twitterFields').classList.remove('hidden');
                document.getElementById('taskPlatform').value = 'twitter';
                document.getElementById('taskType').value = 'social';
                // Setup Twitter action type change handler
                document.getElementById('twitterActionType').onchange = updateTwitterFields;
                updateTwitterFields();
            } else if (type === 'telegram') {
                document.getElementById('telegramFields').classList.remove('hidden');
                document.getElementById('taskPlatform').value = 'telegram';
                document.getElementById('taskType').value = 'social';
            } else if (type === 'youtube') {
                document.getElementById('youtubeFields').classList.remove('hidden');
                document.getElementById('taskPlatform').value = 'youtube';
                document.getElementById('taskType').value = 'content';
            } else if (type === 'daily') {
                document.getElementById('dailyFields').classList.remove('hidden');
                document.getElementById('taskPlatform').value = 'daily';
                document.getElementById('taskType').value = 'engagement';
            } else if (type === 'manual') {
                document.getElementById('manualFields').classList.remove('hidden');
                document.getElementById('taskPlatform').value = 'manual';
                document.getElementById('taskType').value = 'engagement';
            }

            // Show submit button
            document.getElementById('submitQuestBtn').classList.remove('hidden');
        }

        function updateTwitterFields() {
            const actionType = document.getElementById('twitterActionType').value;
            const tweetField = document.getElementById('twitterTweetField');
            const usernameField = document.getElementById('twitterUsernameField');

            if (actionType === 'follow') {
                usernameField.style.display = 'block';
                tweetField.classList.add('hidden');
            } else {
                usernameField.style.display = 'block';
                tweetField.classList.remove('hidden');
            }
        }
        
        function toggleYouTubeVerification() {
            const platform = document.getElementById('taskPlatform').value;
            const verificationSection = document.getElementById('youtubeVerification');
            
            if (platform === 'youtube') {
                verificationSection.classList.remove('hidden');
            } else {
                verificationSection.classList.add('hidden');
            }
        }

        function showAddRewardModal() {
            document.getElementById('rewardModal').classList.remove('hidden');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // Check if already logged in
        window.onload = async function() {
            const token = localStorage.getItem('authToken');
            if (token) {
                authToken = token;
                
                // Validate token by making a test API call
                try {
                    const response = await fetch(`${API_URL}/tasks`, {
                        headers: { 'Authorization': `Bearer ${authToken}` }
                    });
                    
                    if (response.ok) {
                        // Token is valid
                        document.getElementById('loginScreen').classList.add('hidden');
                        document.getElementById('adminDashboard').classList.remove('hidden');
                        loadDashboard();
                    } else if (response.status === 401) {
                        // Token expired or invalid
                        handleAuthError();
                    }
                } catch (error) {
                    console.error('Token validation failed:', error);
                    // Clear invalid token
                    localStorage.removeItem('authToken');
                    authToken = null;
                }
            }
        };
    </script>
    <script src="https://unpkg.com/flowbite@1.7.0/dist/flowbite.js"></script>
</body>
</html>
